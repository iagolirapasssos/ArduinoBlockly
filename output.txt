ExternalExtensions/cryptograph_extension.js:
// static/arduino_blocks.js
Blockly.Blocks['caesar_encrypt'] = {
    init: function() {
        this.appendValueInput("TEXT")
            .setCheck("String")
            .appendField("Encrypt text");
        this.appendValueInput("SHIFT")
            .setCheck("Number")
            .appendField("with shift");
        this.setInputsInline(true);
        this.setOutput(true, "String");
        this.setColour(160);
        this.setTooltip("Encrypt text using Caesar Cipher");
        this.setHelpUrl("");
    }
};

Blockly.Blocks['caesar_decrypt'] = {
    init: function() {
        this.appendValueInput("TEXT")
            .setCheck("String")
            .appendField("Decrypt text");
        this.appendValueInput("SHIFT")
            .setCheck("Number")
            .appendField("with shift");
        this.setInputsInline(true);
        this.setOutput(true, "String");
        this.setColour(160);
        this.setTooltip("Decrypt text using Caesar Cipher");
        this.setHelpUrl("");
    }
};


// static/arduino_generator.js

Blockly.Arduino['caesar_encrypt'] = function(block) {
    var text = Blockly.Arduino.valueToCode(block, 'TEXT', Blockly.Arduino.ORDER_ATOMIC);
    var shift = Blockly.Arduino.valueToCode(block, 'SHIFT', Blockly.Arduino.ORDER_ATOMIC);
    
    var code = 'caesarEncrypt(' + text + ', ' + shift + ')';
    return [code, Blockly.Arduino.ORDER_NONE];
};

Blockly.Arduino['caesar_decrypt'] = function(block) {
    var text = Blockly.Arduino.valueToCode(block, 'TEXT', Blockly.Arduino.ORDER_ATOMIC);
    var shift = Blockly.Arduino.valueToCode(block, 'SHIFT', Blockly.Arduino.ORDER_ATOMIC);
    
    var code = 'caesarDecrypt(' + text + ', ' + shift + ')';
    return [code, Blockly.Arduino.ORDER_NONE];
};


index.html:
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Arduino Blockly IDE</title>
    <link rel="stylesheet" href="static/style.css">
    <link rel="icon" href="static/favicon.ico">
    <script src="https://unpkg.com/blockly/blockly_compressed.js"></script>
    <script src="https://unpkg.com/blockly/blocks_compressed.js"></script>
    <script src="https://unpkg.com/blockly/blockly.min.js"></script>
    <script src="https://unpkg.com/blockly/javascript_compressed.js"></script>
    <script src="https://unpkg.com/blockly/msg/en.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.4.0/highlight.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.4.0/styles/atom-one-dark.min.css">
    <script src="static/arduino_blocks.js"></script>
    <script src="static/arduino_generator.js"></script>
    <script src="static/script.js"></script>
</head>
<body>
    <header>
        <nav>
            <ul>
                <li><a href="#">File</a>
                    <ul>
                        <li><a href="#" id="saveBtn">Save</a></li>
                        <li><a href="#" id="openBtn">Open</a></li>
                    </ul>
                </li>
                <li><a href="#">Help</a>
                    <ul>
                        <li><a href="#">About</a></li>
                        <li><a href="#">Contact</a></li>
                        <li><a href="#">Documents</a></li>
                    </ul>
                </li>
                <li><a href="#" id="executeBtn">Run</a></li>
            </ul>
        </nav>
    </header>
    <div class="container">
        <div class="editor-container">
            <h2>Codeblocks</h2>
            <div id="blocklyDiv" class="blockly-area"></div>
            <xml id="toolbox" style="display: none">
                <category name="Logic" colour="%{BKY_LOGIC_HUE}">
                    <block type="controls_if"></block>
                    <block type="logic_compare"></block>
                    <block type="logic_operation"></block>
                    <block type="logic_negate"></block>
                    <block type="logic_boolean"></block>
                    <block type="logic_null"></block>
                    <block type="logic_ternary"></block>
                </category>
                <category name="Loops" colour="%{BKY_LOOPS_HUE}">
                    <block type="controls_repeat_ext">
                        <value name="TIMES">
                            <shadow type="math_number">
                                <field name="NUM">10</field>
                            </shadow>
                        </value>
                    </block>
                    <block type="controls_whileUntil"></block>
                    <block type="controls_for">
                        <value name="FROM">
                            <shadow type="math_number">
                                <field name="NUM">1</field>
                            </shadow>
                        </value>
                        <value name="TO">
                            <shadow type="math_number">
                                <field name="NUM">10</field>
                            </shadow>
                        </value>
                        <value name="BY">
                            <shadow type="math_number">
                                <field name="NUM">1</field>
                            </shadow>
                        </value>
                    </block>
                    <block type="controls_forEach"></block>
                    <block type="controls_flow_statements"></block>
                </category>
                <category name="Math" colour="%{BKY_MATH_HUE}">
                    <block type="math_number">
                      <field name="NUM">0</field>
                    </block>

                    <block type="math_arithmetic"></block>
                    <block type="math_single"></block>
                    <block type="math_trig"></block>
                    <block type="math_constant"></block>
                    <block type="math_number_property"></block>
                    <block type="math_round"></block>
                    <block type="math_on_list"></block>
                    <block type="math_modulo"></block>
                    <block type="math_constrain">
                        <value name="LOW">
                            <shadow type="math_number">
                                <field name="NUM">1</field>
                            </shadow>
                        </value>
                        <value name="HIGH">
                            <shadow type="math_number">
                                <field name="NUM">100</field>
                            </shadow>
                        </value>
                    </block>
                    <block type="math_random_int">
                        <value name="FROM">
                            <shadow type="math_number">
                                <field name="NUM">1</field>
                            </shadow>
                        </value>
                        <value name="TO">
                            <shadow type="math_number">
                                <field name="NUM">100</field>
                            </shadow>
                        </value>
                    </block>
                    <block type="math_random_float"></block>
                </category>
                <category name="Text" colour="%{BKY_TEXTS_HUE}">
                    <block type="text"></block>
                    <block type="text_join"></block>
                    <block type="text_append">
                        <value name="TEXT">
                            <shadow type="text"></shadow>
                        </value>
                    </block>
                    <block type="text_length"></block>
                    <block type="text_isEmpty"></block>
                    <block type="text_indexOf">
                        <value name="VALUE">
                            <block type="variables_get">
                                <field name="VAR">text</field>
                            </block>
                        </value>
                    </block>
                    <block type="text_charAt">
                        <value name="VALUE">
                            <block type="variables_get">
                                <field name="VAR">text</field>
                            </block>
                        </value>
                    </block>
                    <block type="text_getSubstring">
                        <value name="STRING">
                            <block type="variables_get">
                                <field name="VAR">text</field>
                            </block>
                        </value>
                    </block>
                    <block type="text_changeCase"></block>
                    <block type="text_trim"></block>
                    <block type="text_print"></block>
                    <block type="text_prompt_ext">
                        <value name="TEXT">
                            <shadow type="text"></shadow>
                        </value>
                    </block>
                </category>
                <category name="Lists" colour="%{BKY_LISTS_HUE}">
                    <block type="lists_create_with"></block>
                    <block type="lists_create_with">
                        <mutation items="0"></mutation>
                    </block>
                    <block type="lists_repeat">
                        <value name="NUM">
                            <shadow type="math_number">
                                <field name="NUM">5</field>
                            </shadow>
                        </value>
                    </block>
                    <block type="lists_length"></block>
                    <block type="lists_isEmpty"></block>
                    <block type="lists_indexOf">
                        <value name="VALUE">
                            <block type="variables_get">
                                <field name="VAR">list</field>
                            </block>
                        </value>
                    </block>
                    <block type="lists_getIndex">
                        <value name="VALUE">
                            <block type="variables_get">
                                <field name="VAR">list</field>
                            </block>
                        </value>
                    </block>
                    <block type="lists_setIndex">
                        <value name="LIST">
                            <block type="variables_get">
                                <field name="VAR">list</field>
                            </block>
                        </value>
                    </block>
                    <block type="lists_getSublist">
                        <value name="LIST">
                            <block type="variables_get">
                                <field name="VAR">list</field>
                            </block>
                        </value>
                    </block>
                    <block type="lists_split">
                        <value name="DELIM">
                            <shadow type="text">
                                <field name="TEXT">,</field>
                            </shadow>
                        </value>
                    </block>
                    <block type="lists_sort"></block>
                </category>
                <category name="Variables" colour="%{BKY_VARIABLES_HUE}">
                    <block type="variables_declare_number"></block>
                    <block type="variables_declare_text"></block>
                    <block type="variables_declare_boolean"></block>
                    <block type="variables_get_number"></block>
                    <block type="variables_get_text"></block>
                    <block type="variables_get_boolean"></block>
                </category>
                <category name="Functions" colour="%{BKY_PROCEDURES_HUE}" custom="PROCEDURE"></category>
                <category name="Arduino" colour="230">
                    <block type="arduino_setup"></block>
                    <block type="arduino_loop"></block>
                    <block type="arduino_digital_write"></block>
                    <block type="arduino_digital_read"></block>
                    <!-- Add other Arduino blocks here -->
                </category>
                <category name="Extensions" colour="160" id="extensionsCategory">
                    <button text="Send Extension" callbackKey="sendExtension"></button>
                </category>
            </xml>
            <input type="file" id="extensionInput" style="display:none;" />
        </div>
        <div class="output-container">
            <h2>Output</h2>
            <pre id="code-output" class="hljs language-cpp"></pre>
        </div>
        <div class="terminal-container">
            <h2>Terminal</h2>
            <div id="terminal"></div>
        </div>
    </div>
</body>
</html>


LICENSE:
MIT License

Copyright (c) 2024 Iago lira

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.


package.json:
{
  "name": "mitappinventorcodeblocks",
  "version": "1.0.0",
  "description": "MIT App Inventor Codeblocks",
  "main": "app.js",
  "scripts": {
    "start": "node app.js"
  },
  "dependencies": {
    "@blockly/theme-dark": "^7.0.1",
    "@blockly/workspace-backpack": "^6.0.2",
    "jsdom": "^21.1.2",
    "module-alias": "^2.2.3"
  },
  "author": "Francisco Iago Lira Passos",
  "license": "MIT"
}


package-lock.json:
{
  "name": "mitappinventorcodeblocks",
  "version": "1.0.0",
  "lockfileVersion": 3,
  "requires": true,
  "packages": {
    "": {
      "name": "mitappinventorcodeblocks",
      "version": "1.0.0",
      "license": "MIT",
      "dependencies": {
        "@blockly/theme-dark": "^7.0.1",
        "@blockly/workspace-backpack": "^6.0.2",
        "jsdom": "^21.1.2",
        "module-alias": "^2.2.3"
      }
    },
    "node_modules/@blockly/theme-dark": {
      "version": "7.0.1",
      "resolved": "https://registry.npmjs.org/@blockly/theme-dark/-/theme-dark-7.0.1.tgz",
      "integrity": "sha512-yJZmdV/8ZZQ/NvL1QncTwuxDay/XwyCPr8qYHpfqYii2zOBCtSTxpK5KaF/RHHVwBti0j2c8qEp/AdJ1J3nuSg==",
      "engines": {
        "node": ">=8.17.0"
      },
      "peerDependencies": {
        "blockly": "^11.0.0"
      }
    },
    "node_modules/@blockly/workspace-backpack": {
      "version": "6.0.2",
      "resolved": "https://registry.npmjs.org/@blockly/workspace-backpack/-/workspace-backpack-6.0.2.tgz",
      "integrity": "sha512-51ELeeOWyJB/YNuQP93fCyHrSYniqhU5RugxV/bCdtBsqi3sLerMEVO2EGxQfRLlS8m+8nuc15USuknIlUB24Q==",
      "engines": {
        "node": ">=8.17.0"
      },
      "peerDependencies": {
        "blockly": "^11.0.0"
      }
    },
    "node_modules/@tootallnate/once": {
      "version": "2.0.0",
      "resolved": "https://registry.npmjs.org/@tootallnate/once/-/once-2.0.0.tgz",
      "integrity": "sha512-XCuKFP5PS55gnMVu3dty8KPatLqUoy/ZYzDzAGCQ8JNFCkLXzmI7vNHCR+XpbZaMWQK/vQubr7PkYq8g470J/A==",
      "engines": {
        "node": ">= 10"
      }
    },
    "node_modules/abab": {
      "version": "2.0.6",
      "resolved": "https://registry.npmjs.org/abab/-/abab-2.0.6.tgz",
      "integrity": "sha512-j2afSsaIENvHZN2B8GOpF566vZ5WVk5opAiMTvWgaQT8DkbOqsTfvNAvHoRGU2zzP8cPoqys+xHTRDWW8L+/BA==",
      "deprecated": "Use your platform's native atob() and btoa() methods instead"
    },
    "node_modules/acorn": {
      "version": "8.12.0",
      "resolved": "https://registry.npmjs.org/acorn/-/acorn-8.12.0.tgz",
      "integrity": "sha512-RTvkC4w+KNXrM39/lWCUaG0IbRkWdCv7W/IOW9oU6SawyxulvkQy5HQPVTKxEjczcUvapcrw3cFx/60VN/NRNw==",
      "bin": {
        "acorn": "bin/acorn"
      },
      "engines": {
        "node": ">=0.4.0"
      }
    },
    "node_modules/acorn-globals": {
      "version": "7.0.1",
      "resolved": "https://registry.npmjs.org/acorn-globals/-/acorn-globals-7.0.1.tgz",
      "integrity": "sha512-umOSDSDrfHbTNPuNpC2NSnnA3LUrqpevPb4T9jRx4MagXNS0rs+gwiTcAvqCRmsD6utzsrzNt+ebm00SNWiC3Q==",
      "dependencies": {
        "acorn": "^8.1.0",
        "acorn-walk": "^8.0.2"
      }
    },
    "node_modules/acorn-walk": {
      "version": "8.3.3",
      "resolved": "https://registry.npmjs.org/acorn-walk/-/acorn-walk-8.3.3.tgz",
      "integrity": "sha512-MxXdReSRhGO7VlFe1bRG/oI7/mdLV9B9JJT0N8vZOhF7gFRR5l3M8W9G8JxmKV+JC5mGqJ0QvqfSOLsCPa4nUw==",
      "dependencies": {
        "acorn": "^8.11.0"
      },
      "engines": {
        "node": ">=0.4.0"
      }
    },
    "node_modules/agent-base": {
      "version": "6.0.2",
      "resolved": "https://registry.npmjs.org/agent-base/-/agent-base-6.0.2.tgz",
      "integrity": "sha512-RZNwNclF7+MS/8bDg70amg32dyeZGZxiDuQmZxKLAlQjr3jGyLx+4Kkk58UO7D2QdgFIQCovuSuZESne6RG6XQ==",
      "dependencies": {
        "debug": "4"
      },
      "engines": {
        "node": ">= 6.0.0"
      }
    },
    "node_modules/asynckit": {
      "version": "0.4.0",
      "resolved": "https://registry.npmjs.org/asynckit/-/asynckit-0.4.0.tgz",
      "integrity": "sha512-Oei9OH4tRh0YqU3GxhX79dM/mwVgvbZJaSNaRk+bshkj0S5cfHcgYakreBjrHwatXKbz+IoIdYLxrKim2MjW0Q=="
    },
    "node_modules/blockly": {
      "version": "11.1.1",
      "resolved": "https://registry.npmjs.org/blockly/-/blockly-11.1.1.tgz",
      "integrity": "sha512-PmInYM9zH1HcYMffqnfmeu2O3g0intsowy08S0KDu3q8/95TfGo1tcDYpeWNQDkPOEzN1yy3oocsRO4NPDHtKA==",
      "peer": true,
      "dependencies": {
        "jsdom": "23.0.0"
      },
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/blockly/node_modules/agent-base": {
      "version": "7.1.1",
      "resolved": "https://registry.npmjs.org/agent-base/-/agent-base-7.1.1.tgz",
      "integrity": "sha512-H0TSyFNDMomMNJQBn8wFV5YC/2eJ+VXECwOadZJT554xP6cODZHPX3H9QMQECxvrgiSOP1pHjy1sMWQVYJOUOA==",
      "peer": true,
      "dependencies": {
        "debug": "^4.3.4"
      },
      "engines": {
        "node": ">= 14"
      }
    },
    "node_modules/blockly/node_modules/data-urls": {
      "version": "5.0.0",
      "resolved": "https://registry.npmjs.org/data-urls/-/data-urls-5.0.0.tgz",
      "integrity": "sha512-ZYP5VBHshaDAiVZxjbRVcFJpc+4xGgT0bK3vzy1HLN8jTO975HEbuYzZJcHoQEY5K1a0z8YayJkyVETa08eNTg==",
      "peer": true,
      "dependencies": {
        "whatwg-mimetype": "^4.0.0",
        "whatwg-url": "^14.0.0"
      },
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/blockly/node_modules/html-encoding-sniffer": {
      "version": "4.0.0",
      "resolved": "https://registry.npmjs.org/html-encoding-sniffer/-/html-encoding-sniffer-4.0.0.tgz",
      "integrity": "sha512-Y22oTqIU4uuPgEemfz7NDJz6OeKf12Lsu+QC+s3BVpda64lTiMYCyGwg5ki4vFxkMwQdeZDl2adZoqUgdFuTgQ==",
      "peer": true,
      "dependencies": {
        "whatwg-encoding": "^3.1.1"
      },
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/blockly/node_modules/http-proxy-agent": {
      "version": "7.0.2",
      "resolved": "https://registry.npmjs.org/http-proxy-agent/-/http-proxy-agent-7.0.2.tgz",
      "integrity": "sha512-T1gkAiYYDWYx3V5Bmyu7HcfcvL7mUrTWiM6yOfa3PIphViJ/gFPbvidQ+veqSOHci/PxBcDabeUNCzpOODJZig==",
      "peer": true,
      "dependencies": {
        "agent-base": "^7.1.0",
        "debug": "^4.3.4"
      },
      "engines": {
        "node": ">= 14"
      }
    },
    "node_modules/blockly/node_modules/https-proxy-agent": {
      "version": "7.0.4",
      "resolved": "https://registry.npmjs.org/https-proxy-agent/-/https-proxy-agent-7.0.4.tgz",
      "integrity": "sha512-wlwpilI7YdjSkWaQ/7omYBMTliDcmCN8OLihO6I9B86g06lMyAoqgoDpV0XqoaPOKj+0DIdAvnsWfyAAhmimcg==",
      "peer": true,
      "dependencies": {
        "agent-base": "^7.0.2",
        "debug": "4"
      },
      "engines": {
        "node": ">= 14"
      }
    },
    "node_modules/blockly/node_modules/jsdom": {
      "version": "23.0.0",
      "resolved": "https://registry.npmjs.org/jsdom/-/jsdom-23.0.0.tgz",
      "integrity": "sha512-cbL/UCtohJguhFC7c2/hgW6BeZCNvP7URQGnx9tSJRYKCdnfbfWOrtuLTMfiB2VxKsx5wPHVsh/J0aBy9lIIhQ==",
      "peer": true,
      "dependencies": {
        "cssstyle": "^3.0.0",
        "data-urls": "^5.0.0",
        "decimal.js": "^10.4.3",
        "form-data": "^4.0.0",
        "html-encoding-sniffer": "^4.0.0",
        "http-proxy-agent": "^7.0.0",
        "https-proxy-agent": "^7.0.2",
        "is-potential-custom-element-name": "^1.0.1",
        "nwsapi": "^2.2.7",
        "parse5": "^7.1.2",
        "rrweb-cssom": "^0.6.0",
        "saxes": "^6.0.0",
        "symbol-tree": "^3.2.4",
        "tough-cookie": "^4.1.3",
        "w3c-xmlserializer": "^5.0.0",
        "webidl-conversions": "^7.0.0",
        "whatwg-encoding": "^3.1.1",
        "whatwg-mimetype": "^4.0.0",
        "whatwg-url": "^14.0.0",
        "ws": "^8.14.2",
        "xml-name-validator": "^5.0.0"
      },
      "engines": {
        "node": ">=18"
      },
      "peerDependencies": {
        "canvas": "^3.0.0"
      },
      "peerDependenciesMeta": {
        "canvas": {
          "optional": true
        }
      }
    },
    "node_modules/blockly/node_modules/tr46": {
      "version": "5.0.0",
      "resolved": "https://registry.npmjs.org/tr46/-/tr46-5.0.0.tgz",
      "integrity": "sha512-tk2G5R2KRwBd+ZN0zaEXpmzdKyOYksXwywulIX95MBODjSzMIuQnQ3m8JxgbhnL1LeVo7lqQKsYa1O3Htl7K5g==",
      "peer": true,
      "dependencies": {
        "punycode": "^2.3.1"
      },
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/blockly/node_modules/w3c-xmlserializer": {
      "version": "5.0.0",
      "resolved": "https://registry.npmjs.org/w3c-xmlserializer/-/w3c-xmlserializer-5.0.0.tgz",
      "integrity": "sha512-o8qghlI8NZHU1lLPrpi2+Uq7abh4GGPpYANlalzWxyWteJOCsr/P+oPBA49TOLu5FTZO4d3F9MnWJfiMo4BkmA==",
      "peer": true,
      "dependencies": {
        "xml-name-validator": "^5.0.0"
      },
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/blockly/node_modules/whatwg-encoding": {
      "version": "3.1.1",
      "resolved": "https://registry.npmjs.org/whatwg-encoding/-/whatwg-encoding-3.1.1.tgz",
      "integrity": "sha512-6qN4hJdMwfYBtE3YBTTHhoeuUrDBPZmbQaxWAqSALV/MeEnR5z1xd8UKud2RAkFoPkmB+hli1TZSnyi84xz1vQ==",
      "peer": true,
      "dependencies": {
        "iconv-lite": "0.6.3"
      },
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/blockly/node_modules/whatwg-mimetype": {
      "version": "4.0.0",
      "resolved": "https://registry.npmjs.org/whatwg-mimetype/-/whatwg-mimetype-4.0.0.tgz",
      "integrity": "sha512-QaKxh0eNIi2mE9p2vEdzfagOKHCcj1pJ56EEHGQOVxp8r9/iszLUUV7v89x9O1p/T+NlTM5W7jW6+cz4Fq1YVg==",
      "peer": true,
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/blockly/node_modules/whatwg-url": {
      "version": "14.0.0",
      "resolved": "https://registry.npmjs.org/whatwg-url/-/whatwg-url-14.0.0.tgz",
      "integrity": "sha512-1lfMEm2IEr7RIV+f4lUNPOqfFL+pO+Xw3fJSqmjX9AbXcXcYOkCe1P6+9VBZB6n94af16NfZf+sSk0JCBZC9aw==",
      "peer": true,
      "dependencies": {
        "tr46": "^5.0.0",
        "webidl-conversions": "^7.0.0"
      },
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/blockly/node_modules/xml-name-validator": {
      "version": "5.0.0",
      "resolved": "https://registry.npmjs.org/xml-name-validator/-/xml-name-validator-5.0.0.tgz",
      "integrity": "sha512-EvGK8EJ3DhaHfbRlETOWAS5pO9MZITeauHKJyb8wyajUfQUenkIg2MvLDTZ4T/TgIcm3HU0TFBgWWboAZ30UHg==",
      "peer": true,
      "engines": {
        "node": ">=18"
      }
    },
    "node_modules/combined-stream": {
      "version": "1.0.8",
      "resolved": "https://registry.npmjs.org/combined-stream/-/combined-stream-1.0.8.tgz",
      "integrity": "sha512-FQN4MRfuJeHf7cBbBMJFXhKSDq+2kAArBlmRBvcvFE5BB1HZKXtSFASDhdlz9zOYwxh8lDdnvmMOe/+5cdoEdg==",
      "dependencies": {
        "delayed-stream": "~1.0.0"
      },
      "engines": {
        "node": ">= 0.8"
      }
    },
    "node_modules/cssstyle": {
      "version": "3.0.0",
      "resolved": "https://registry.npmjs.org/cssstyle/-/cssstyle-3.0.0.tgz",
      "integrity": "sha512-N4u2ABATi3Qplzf0hWbVCdjenim8F3ojEXpBDF5hBpjzW182MjNGLqfmQ0SkSPeQ+V86ZXgeH8aXj6kayd4jgg==",
      "dependencies": {
        "rrweb-cssom": "^0.6.0"
      },
      "engines": {
        "node": ">=14"
      }
    },
    "node_modules/data-urls": {
      "version": "4.0.0",
      "resolved": "https://registry.npmjs.org/data-urls/-/data-urls-4.0.0.tgz",
      "integrity": "sha512-/mMTei/JXPqvFqQtfyTowxmJVwr2PVAeCcDxyFf6LhoOu/09TX2OX3kb2wzi4DMXcfj4OItwDOnhl5oziPnT6g==",
      "dependencies": {
        "abab": "^2.0.6",
        "whatwg-mimetype": "^3.0.0",
        "whatwg-url": "^12.0.0"
      },
      "engines": {
        "node": ">=14"
      }
    },
    "node_modules/debug": {
      "version": "4.3.5",
      "resolved": "https://registry.npmjs.org/debug/-/debug-4.3.5.tgz",
      "integrity": "sha512-pt0bNEmneDIvdL1Xsd9oDQ/wrQRkXDT4AUWlNZNPKvW5x/jyO9VFXkJUP07vQ2upmw5PlaITaPKc31jK13V+jg==",
      "dependencies": {
        "ms": "2.1.2"
      },
      "engines": {
        "node": ">=6.0"
      },
      "peerDependenciesMeta": {
        "supports-color": {
          "optional": true
        }
      }
    },
    "node_modules/decimal.js": {
      "version": "10.4.3",
      "resolved": "https://registry.npmjs.org/decimal.js/-/decimal.js-10.4.3.tgz",
      "integrity": "sha512-VBBaLc1MgL5XpzgIP7ny5Z6Nx3UrRkIViUkPUdtl9aya5amy3De1gsUUSB1g3+3sExYNjCAsAznmukyxCb1GRA=="
    },
    "node_modules/delayed-stream": {
      "version": "1.0.0",
      "resolved": "https://registry.npmjs.org/delayed-stream/-/delayed-stream-1.0.0.tgz",
      "integrity": "sha512-ZySD7Nf91aLB0RxL4KGrKHBXl7Eds1DAmEdcoVawXnLD7SDhpNgtuII2aAkg7a7QS41jxPSZ17p4VdGnMHk3MQ==",
      "engines": {
        "node": ">=0.4.0"
      }
    },
    "node_modules/domexception": {
      "version": "4.0.0",
      "resolved": "https://registry.npmjs.org/domexception/-/domexception-4.0.0.tgz",
      "integrity": "sha512-A2is4PLG+eeSfoTMA95/s4pvAoSo2mKtiM5jlHkAVewmiO8ISFTFKZjH7UAM1Atli/OT/7JHOrJRJiMKUZKYBw==",
      "deprecated": "Use your platform's native DOMException instead",
      "dependencies": {
        "webidl-conversions": "^7.0.0"
      },
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/entities": {
      "version": "4.5.0",
      "resolved": "https://registry.npmjs.org/entities/-/entities-4.5.0.tgz",
      "integrity": "sha512-V0hjH4dGPh9Ao5p0MoRY6BVqtwCjhz6vI5LT8AJ55H+4g9/4vbHx1I54fS0XuclLhDHArPQCiMjDxjaL8fPxhw==",
      "engines": {
        "node": ">=0.12"
      },
      "funding": {
        "url": "https://github.com/fb55/entities?sponsor=1"
      }
    },
    "node_modules/escodegen": {
      "version": "2.1.0",
      "resolved": "https://registry.npmjs.org/escodegen/-/escodegen-2.1.0.tgz",
      "integrity": "sha512-2NlIDTwUWJN0mRPQOdtQBzbUHvdGY2P1VXSyU83Q3xKxM7WHX2Ql8dKq782Q9TgQUNOLEzEYu9bzLNj1q88I5w==",
      "dependencies": {
        "esprima": "^4.0.1",
        "estraverse": "^5.2.0",
        "esutils": "^2.0.2"
      },
      "bin": {
        "escodegen": "bin/escodegen.js",
        "esgenerate": "bin/esgenerate.js"
      },
      "engines": {
        "node": ">=6.0"
      },
      "optionalDependencies": {
        "source-map": "~0.6.1"
      }
    },
    "node_modules/esprima": {
      "version": "4.0.1",
      "resolved": "https://registry.npmjs.org/esprima/-/esprima-4.0.1.tgz",
      "integrity": "sha512-eGuFFw7Upda+g4p+QHvnW0RyTX/SVeJBDM/gCtMARO0cLuT2HcEKnTPvhjV6aGeqrCB/sbNop0Kszm0jsaWU4A==",
      "bin": {
        "esparse": "bin/esparse.js",
        "esvalidate": "bin/esvalidate.js"
      },
      "engines": {
        "node": ">=4"
      }
    },
    "node_modules/estraverse": {
      "version": "5.3.0",
      "resolved": "https://registry.npmjs.org/estraverse/-/estraverse-5.3.0.tgz",
      "integrity": "sha512-MMdARuVEQziNTeJD8DgMqmhwR11BRQ/cBP+pLtYdSTnf3MIO8fFeiINEbX36ZdNlfU/7A9f3gUw49B3oQsvwBA==",
      "engines": {
        "node": ">=4.0"
      }
    },
    "node_modules/esutils": {
      "version": "2.0.3",
      "resolved": "https://registry.npmjs.org/esutils/-/esutils-2.0.3.tgz",
      "integrity": "sha512-kVscqXk4OCp68SZ0dkgEKVi6/8ij300KBWTJq32P/dYeWTSwK41WyTxalN1eRmA5Z9UU/LX9D7FWSmV9SAYx6g==",
      "engines": {
        "node": ">=0.10.0"
      }
    },
    "node_modules/form-data": {
      "version": "4.0.0",
      "resolved": "https://registry.npmjs.org/form-data/-/form-data-4.0.0.tgz",
      "integrity": "sha512-ETEklSGi5t0QMZuiXoA/Q6vcnxcLQP5vdugSpuAyi6SVGi2clPPp+xgEhuMaHC+zGgn31Kd235W35f7Hykkaww==",
      "dependencies": {
        "asynckit": "^0.4.0",
        "combined-stream": "^1.0.8",
        "mime-types": "^2.1.12"
      },
      "engines": {
        "node": ">= 6"
      }
    },
    "node_modules/html-encoding-sniffer": {
      "version": "3.0.0",
      "resolved": "https://registry.npmjs.org/html-encoding-sniffer/-/html-encoding-sniffer-3.0.0.tgz",
      "integrity": "sha512-oWv4T4yJ52iKrufjnyZPkrN0CH3QnrUqdB6In1g5Fe1mia8GmF36gnfNySxoZtxD5+NmYw1EElVXiBk93UeskA==",
      "dependencies": {
        "whatwg-encoding": "^2.0.0"
      },
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/http-proxy-agent": {
      "version": "5.0.0",
      "resolved": "https://registry.npmjs.org/http-proxy-agent/-/http-proxy-agent-5.0.0.tgz",
      "integrity": "sha512-n2hY8YdoRE1i7r6M0w9DIw5GgZN0G25P8zLCRQ8rjXtTU3vsNFBI/vWK/UIeE6g5MUUz6avwAPXmL6Fy9D/90w==",
      "dependencies": {
        "@tootallnate/once": "2",
        "agent-base": "6",
        "debug": "4"
      },
      "engines": {
        "node": ">= 6"
      }
    },
    "node_modules/https-proxy-agent": {
      "version": "5.0.1",
      "resolved": "https://registry.npmjs.org/https-proxy-agent/-/https-proxy-agent-5.0.1.tgz",
      "integrity": "sha512-dFcAjpTQFgoLMzC2VwU+C/CbS7uRL0lWmxDITmqm7C+7F0Odmj6s9l6alZc6AELXhrnggM2CeWSXHGOdX2YtwA==",
      "dependencies": {
        "agent-base": "6",
        "debug": "4"
      },
      "engines": {
        "node": ">= 6"
      }
    },
    "node_modules/iconv-lite": {
      "version": "0.6.3",
      "resolved": "https://registry.npmjs.org/iconv-lite/-/iconv-lite-0.6.3.tgz",
      "integrity": "sha512-4fCk79wshMdzMp2rH06qWrJE4iolqLhCUH+OiuIgU++RB0+94NlDL81atO7GX55uUKueo0txHNtvEyI6D7WdMw==",
      "dependencies": {
        "safer-buffer": ">= 2.1.2 < 3.0.0"
      },
      "engines": {
        "node": ">=0.10.0"
      }
    },
    "node_modules/is-potential-custom-element-name": {
      "version": "1.0.1",
      "resolved": "https://registry.npmjs.org/is-potential-custom-element-name/-/is-potential-custom-element-name-1.0.1.tgz",
      "integrity": "sha512-bCYeRA2rVibKZd+s2625gGnGF/t7DSqDs4dP7CrLA1m7jKWz6pps0LpYLJN8Q64HtmPKJ1hrN3nzPNKFEKOUiQ=="
    },
    "node_modules/jsdom": {
      "version": "21.1.2",
      "resolved": "https://registry.npmjs.org/jsdom/-/jsdom-21.1.2.tgz",
      "integrity": "sha512-sCpFmK2jv+1sjff4u7fzft+pUh2KSUbUrEHYHyfSIbGTIcmnjyp83qg6qLwdJ/I3LpTXx33ACxeRL7Lsyc6lGQ==",
      "dependencies": {
        "abab": "^2.0.6",
        "acorn": "^8.8.2",
        "acorn-globals": "^7.0.0",
        "cssstyle": "^3.0.0",
        "data-urls": "^4.0.0",
        "decimal.js": "^10.4.3",
        "domexception": "^4.0.0",
        "escodegen": "^2.0.0",
        "form-data": "^4.0.0",
        "html-encoding-sniffer": "^3.0.0",
        "http-proxy-agent": "^5.0.0",
        "https-proxy-agent": "^5.0.1",
        "is-potential-custom-element-name": "^1.0.1",
        "nwsapi": "^2.2.4",
        "parse5": "^7.1.2",
        "rrweb-cssom": "^0.6.0",
        "saxes": "^6.0.0",
        "symbol-tree": "^3.2.4",
        "tough-cookie": "^4.1.2",
        "w3c-xmlserializer": "^4.0.0",
        "webidl-conversions": "^7.0.0",
        "whatwg-encoding": "^2.0.0",
        "whatwg-mimetype": "^3.0.0",
        "whatwg-url": "^12.0.1",
        "ws": "^8.13.0",
        "xml-name-validator": "^4.0.0"
      },
      "engines": {
        "node": ">=14"
      },
      "peerDependencies": {
        "canvas": "^2.5.0"
      },
      "peerDependenciesMeta": {
        "canvas": {
          "optional": true
        }
      }
    },
    "node_modules/mime-db": {
      "version": "1.52.0",
      "resolved": "https://registry.npmjs.org/mime-db/-/mime-db-1.52.0.tgz",
      "integrity": "sha512-sPU4uV7dYlvtWJxwwxHD0PuihVNiE7TyAbQ5SWxDCB9mUYvOgroQOwYQQOKPJ8CIbE+1ETVlOoK1UC2nU3gYvg==",
      "engines": {
        "node": ">= 0.6"
      }
    },
    "node_modules/mime-types": {
      "version": "2.1.35",
      "resolved": "https://registry.npmjs.org/mime-types/-/mime-types-2.1.35.tgz",
      "integrity": "sha512-ZDY+bPm5zTTF+YpCrAU9nK0UgICYPT0QtT1NZWFv4s++TNkcgVaT0g6+4R2uI4MjQjzysHB1zxuWL50hzaeXiw==",
      "dependencies": {
        "mime-db": "1.52.0"
      },
      "engines": {
        "node": ">= 0.6"
      }
    },
    "node_modules/module-alias": {
      "version": "2.2.3",
      "resolved": "https://registry.npmjs.org/module-alias/-/module-alias-2.2.3.tgz",
      "integrity": "sha512-23g5BFj4zdQL/b6tor7Ji+QY4pEfNH784BMslY9Qb0UnJWRAt+lQGLYmRaM0KDBwIG23ffEBELhZDP2rhi9f/Q=="
    },
    "node_modules/ms": {
      "version": "2.1.2",
      "resolved": "https://registry.npmjs.org/ms/-/ms-2.1.2.tgz",
      "integrity": "sha512-sGkPx+VjMtmA6MX27oA4FBFELFCZZ4S4XqeGOXCv68tT+jb3vk/RyaKWP0PTKyWtmLSM0b+adUTEvbs1PEaH2w=="
    },
    "node_modules/nwsapi": {
      "version": "2.2.10",
      "resolved": "https://registry.npmjs.org/nwsapi/-/nwsapi-2.2.10.tgz",
      "integrity": "sha512-QK0sRs7MKv0tKe1+5uZIQk/C8XGza4DAnztJG8iD+TpJIORARrCxczA738awHrZoHeTjSSoHqao2teO0dC/gFQ=="
    },
    "node_modules/parse5": {
      "version": "7.1.2",
      "resolved": "https://registry.npmjs.org/parse5/-/parse5-7.1.2.tgz",
      "integrity": "sha512-Czj1WaSVpaoj0wbhMzLmWD69anp2WH7FXMB9n1Sy8/ZFF9jolSQVMu1Ij5WIyGmcBmhk7EOndpO4mIpihVqAXw==",
      "dependencies": {
        "entities": "^4.4.0"
      },
      "funding": {
        "url": "https://github.com/inikulin/parse5?sponsor=1"
      }
    },
    "node_modules/psl": {
      "version": "1.9.0",
      "resolved": "https://registry.npmjs.org/psl/-/psl-1.9.0.tgz",
      "integrity": "sha512-E/ZsdU4HLs/68gYzgGTkMicWTLPdAftJLfJFlLUAAKZGkStNU72sZjT66SnMDVOfOWY/YAoiD7Jxa9iHvngcag=="
    },
    "node_modules/punycode": {
      "version": "2.3.1",
      "resolved": "https://registry.npmjs.org/punycode/-/punycode-2.3.1.tgz",
      "integrity": "sha512-vYt7UD1U9Wg6138shLtLOvdAu+8DsC/ilFtEVHcH+wydcSpNE20AfSOduf6MkRFahL5FY7X1oU7nKVZFtfq8Fg==",
      "engines": {
        "node": ">=6"
      }
    },
    "node_modules/querystringify": {
      "version": "2.2.0",
      "resolved": "https://registry.npmjs.org/querystringify/-/querystringify-2.2.0.tgz",
      "integrity": "sha512-FIqgj2EUvTa7R50u0rGsyTftzjYmv/a3hO345bZNrqabNqjtgiDMgmo4mkUjd+nzU5oF3dClKqFIPUKybUyqoQ=="
    },
    "node_modules/requires-port": {
      "version": "1.0.0",
      "resolved": "https://registry.npmjs.org/requires-port/-/requires-port-1.0.0.tgz",
      "integrity": "sha512-KigOCHcocU3XODJxsu8i/j8T9tzT4adHiecwORRQ0ZZFcp7ahwXuRU1m+yuO90C5ZUyGeGfocHDI14M3L3yDAQ=="
    },
    "node_modules/rrweb-cssom": {
      "version": "0.6.0",
      "resolved": "https://registry.npmjs.org/rrweb-cssom/-/rrweb-cssom-0.6.0.tgz",
      "integrity": "sha512-APM0Gt1KoXBz0iIkkdB/kfvGOwC4UuJFeG/c+yV7wSc7q96cG/kJ0HiYCnzivD9SB53cLV1MlHFNfOuPaadYSw=="
    },
    "node_modules/safer-buffer": {
      "version": "2.1.2",
      "resolved": "https://registry.npmjs.org/safer-buffer/-/safer-buffer-2.1.2.tgz",
      "integrity": "sha512-YZo3K82SD7Riyi0E1EQPojLz7kpepnSQI9IyPbHHg1XXXevb5dJI7tpyN2ADxGcQbHG7vcyRHk0cbwqcQriUtg=="
    },
    "node_modules/saxes": {
      "version": "6.0.0",
      "resolved": "https://registry.npmjs.org/saxes/-/saxes-6.0.0.tgz",
      "integrity": "sha512-xAg7SOnEhrm5zI3puOOKyy1OMcMlIJZYNJY7xLBwSze0UjhPLnWfj2GF2EpT0jmzaJKIWKHLsaSSajf35bcYnA==",
      "dependencies": {
        "xmlchars": "^2.2.0"
      },
      "engines": {
        "node": ">=v12.22.7"
      }
    },
    "node_modules/source-map": {
      "version": "0.6.1",
      "resolved": "https://registry.npmjs.org/source-map/-/source-map-0.6.1.tgz",
      "integrity": "sha512-UjgapumWlbMhkBgzT7Ykc5YXUT46F0iKu8SGXq0bcwP5dz/h0Plj6enJqjz1Zbq2l5WaqYnrVbwWOWMyF3F47g==",
      "optional": true,
      "engines": {
        "node": ">=0.10.0"
      }
    },
    "node_modules/symbol-tree": {
      "version": "3.2.4",
      "resolved": "https://registry.npmjs.org/symbol-tree/-/symbol-tree-3.2.4.tgz",
      "integrity": "sha512-9QNk5KwDF+Bvz+PyObkmSYjI5ksVUYtjW7AU22r2NKcfLJcXp96hkDWU3+XndOsUb+AQ9QhfzfCT2O+CNWT5Tw=="
    },
    "node_modules/tough-cookie": {
      "version": "4.1.4",
      "resolved": "https://registry.npmjs.org/tough-cookie/-/tough-cookie-4.1.4.tgz",
      "integrity": "sha512-Loo5UUvLD9ScZ6jh8beX1T6sO1w2/MpCRpEP7V280GKMVUQ0Jzar2U3UJPsrdbziLEMMhu3Ujnq//rhiFuIeag==",
      "dependencies": {
        "psl": "^1.1.33",
        "punycode": "^2.1.1",
        "universalify": "^0.2.0",
        "url-parse": "^1.5.3"
      },
      "engines": {
        "node": ">=6"
      }
    },
    "node_modules/tr46": {
      "version": "4.1.1",
      "resolved": "https://registry.npmjs.org/tr46/-/tr46-4.1.1.tgz",
      "integrity": "sha512-2lv/66T7e5yNyhAAC4NaKe5nVavzuGJQVVtRYLyQ2OI8tsJ61PMLlelehb0wi2Hx6+hT/OJUWZcw8MjlSRnxvw==",
      "dependencies": {
        "punycode": "^2.3.0"
      },
      "engines": {
        "node": ">=14"
      }
    },
    "node_modules/universalify": {
      "version": "0.2.0",
      "resolved": "https://registry.npmjs.org/universalify/-/universalify-0.2.0.tgz",
      "integrity": "sha512-CJ1QgKmNg3CwvAv/kOFmtnEN05f0D/cn9QntgNOQlQF9dgvVTHj3t+8JPdjqawCHk7V/KA+fbUqzZ9XWhcqPUg==",
      "engines": {
        "node": ">= 4.0.0"
      }
    },
    "node_modules/url-parse": {
      "version": "1.5.10",
      "resolved": "https://registry.npmjs.org/url-parse/-/url-parse-1.5.10.tgz",
      "integrity": "sha512-WypcfiRhfeUP9vvF0j6rw0J3hrWrw6iZv3+22h6iRMJ/8z1Tj6XfLP4DsUix5MhMPnXpiHDoKyoZ/bdCkwBCiQ==",
      "dependencies": {
        "querystringify": "^2.1.1",
        "requires-port": "^1.0.0"
      }
    },
    "node_modules/w3c-xmlserializer": {
      "version": "4.0.0",
      "resolved": "https://registry.npmjs.org/w3c-xmlserializer/-/w3c-xmlserializer-4.0.0.tgz",
      "integrity": "sha512-d+BFHzbiCx6zGfz0HyQ6Rg69w9k19nviJspaj4yNscGjrHu94sVP+aRm75yEbCh+r2/yR+7q6hux9LVtbuTGBw==",
      "dependencies": {
        "xml-name-validator": "^4.0.0"
      },
      "engines": {
        "node": ">=14"
      }
    },
    "node_modules/webidl-conversions": {
      "version": "7.0.0",
      "resolved": "https://registry.npmjs.org/webidl-conversions/-/webidl-conversions-7.0.0.tgz",
      "integrity": "sha512-VwddBukDzu71offAQR975unBIGqfKZpM+8ZX6ySk8nYhVoo5CYaZyzt3YBvYtRtO+aoGlqxPg/B87NGVZ/fu6g==",
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/whatwg-encoding": {
      "version": "2.0.0",
      "resolved": "https://registry.npmjs.org/whatwg-encoding/-/whatwg-encoding-2.0.0.tgz",
      "integrity": "sha512-p41ogyeMUrw3jWclHWTQg1k05DSVXPLcVxRTYsXUk+ZooOCZLcoYgPZ/HL/D/N+uQPOtcp1me1WhBEaX02mhWg==",
      "dependencies": {
        "iconv-lite": "0.6.3"
      },
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/whatwg-mimetype": {
      "version": "3.0.0",
      "resolved": "https://registry.npmjs.org/whatwg-mimetype/-/whatwg-mimetype-3.0.0.tgz",
      "integrity": "sha512-nt+N2dzIutVRxARx1nghPKGv1xHikU7HKdfafKkLNLindmPU/ch3U31NOCGGA/dmPcmb1VlofO0vnKAcsm0o/Q==",
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/whatwg-url": {
      "version": "12.0.1",
      "resolved": "https://registry.npmjs.org/whatwg-url/-/whatwg-url-12.0.1.tgz",
      "integrity": "sha512-Ed/LrqB8EPlGxjS+TrsXcpUond1mhccS3pchLhzSgPCnTimUCKj3IZE75pAs5m6heB2U2TMerKFUXheyHY+VDQ==",
      "dependencies": {
        "tr46": "^4.1.1",
        "webidl-conversions": "^7.0.0"
      },
      "engines": {
        "node": ">=14"
      }
    },
    "node_modules/ws": {
      "version": "8.17.1",
      "resolved": "https://registry.npmjs.org/ws/-/ws-8.17.1.tgz",
      "integrity": "sha512-6XQFvXTkbfUOZOKKILFG1PDK2NDQs4azKQl26T0YS5CxqWLgXajbPZ+h4gZekJyRqFU8pvnbAbbs/3TgRPy+GQ==",
      "engines": {
        "node": ">=10.0.0"
      },
      "peerDependencies": {
        "bufferutil": "^4.0.1",
        "utf-8-validate": ">=5.0.2"
      },
      "peerDependenciesMeta": {
        "bufferutil": {
          "optional": true
        },
        "utf-8-validate": {
          "optional": true
        }
      }
    },
    "node_modules/xml-name-validator": {
      "version": "4.0.0",
      "resolved": "https://registry.npmjs.org/xml-name-validator/-/xml-name-validator-4.0.0.tgz",
      "integrity": "sha512-ICP2e+jsHvAj2E2lIHxa5tjXRlKDJo4IdvPvCXbXQGdzSfmSpNVyIKMvoZHjDY9DP0zV17iI85o90vRFXNccRw==",
      "engines": {
        "node": ">=12"
      }
    },
    "node_modules/xmlchars": {
      "version": "2.2.0",
      "resolved": "https://registry.npmjs.org/xmlchars/-/xmlchars-2.2.0.tgz",
      "integrity": "sha512-JZnDKK8B0RCDw84FNdDAIpZK+JuJw+s7Lz8nksI7SIuU3UXJJslUthsi+uWBUYOwPFwW7W7PRLRfUKpxjtjFCw=="
    }
  }
}


README.md:
# ArduinoBlockly

static/arduino_blocks.js:
// static/arduino_blocks.js
Blockly.Blocks['text_print'] = {
    init: function() {
        this.appendValueInput("TEXT")
            .setCheck(null)
            .appendField(new Blockly.FieldDropdown([["println", "PRINTLN"], ["print", "PRINT"]]), "MODE");
        this.setColour(160);
        this.setTooltip("Prints text to the serial monitor.");
        this.setHelpUrl("");
    }
};


Blockly.Blocks['arduino_setup'] = {
    init: function() {
        this.appendDummyInput()
            .appendField("Setup");
        this.appendStatementInput("SETUP")
            .setCheck(null);
        this.setColour(230);
        this.setTooltip("");
        this.setHelpUrl("");
    }
};

Blockly.Blocks['arduino_loop'] = {
    init: function() {
        this.appendDummyInput()
            .appendField("Loop");
        this.appendStatementInput("LOOP")
            .setCheck(null);
        this.setColour(230);
        this.setTooltip("");
        this.setHelpUrl("");
    }
};

Blockly.Blocks['arduino_digital_write'] = {
    init: function() {
        this.appendValueInput("PIN")
            .setCheck("Number")
            .appendField("Digital Write PIN#");
        this.appendValueInput("STATE")
            .setCheck("Boolean")
            .appendField("State");
        this.setInputsInline(true);
        this.setPreviousStatement(true, null);
        this.setNextStatement(true, null);
        this.setColour(230);
        this.setTooltip("");
        this.setHelpUrl("");
    }
};

Blockly.Blocks['arduino_digital_read'] = {
    init: function() {
        this.appendValueInput("PIN")
            .setCheck("Number")
            .appendField("Digital Read PIN#");
        this.setInputsInline(true);
        this.setOutput(true, "Boolean");
        this.setColour(230);
        this.setTooltip("");
        this.setHelpUrl("");
    }
};

Blockly.Blocks['math_number'] = {
  init: function() {
    this.appendDummyInput()
        .appendField(new Blockly.FieldNumber(0), "NUM");
    this.setOutput(true, "Number");
    this.setColour(230);
    this.setTooltip("");
    this.setHelpUrl("");
  }
};

//Math
//Declare
// Variable Declaration Blocks
Blockly.Blocks['variables_declare_number'] = {
    init: function() {
        this.appendDummyInput()
            .appendField("Declare number")
            .appendField(new Blockly.FieldTextInput("myVarNumber"), "VAR_NAME")
            .appendField(new Blockly.FieldDropdown([
                ["byte", "byte"],
                ["int", "int"],
                ["float", "float"],
                ["long", "long"],
                ["double", "double"]
            ]), "TYPE");
        this.appendValueInput("VALUE")
            .setCheck("Number")
            .appendField("value");
        this.setPreviousStatement(true, null);
        this.setNextStatement(true, null);
        this.setColour(330);
        this.setTooltip("Declare a number variable");
        this.setHelpUrl("");
    },
    onchange: function(event) {
        if (event.type === Blockly.Events.BLOCK_CREATE || 
            event.type === Blockly.Events.BLOCK_CHANGE || 
            event.type === Blockly.Events.BLOCK_MOVE) {
            const varName = this.getFieldValue('VAR_NAME');
            const varType = 'NUMBER';
            const workspace = this.workspace;
            let variable = workspace.getVariable(varName, varType);
            if (!variable) {
                workspace.createVariable(varName, varType);
            } else if (variable.type !== varType) {
                workspace.deleteVariableById(variable.getId());
                workspace.createVariable(varName, varType);
            }
        }
    }
};

Blockly.Blocks['variables_declare_text'] = {
    init: function() {
        this.appendDummyInput()
            .appendField("Declare text")
            .appendField(new Blockly.FieldTextInput("myVarText"), "VAR_NAME")
            .appendField(new Blockly.FieldDropdown([
                ["char", "char"],
                ["String", "String"]
            ]), "TYPE");
        this.appendValueInput("VALUE")
            .setCheck("String")
            .appendField("value");
        this.setPreviousStatement(true, null);
        this.setNextStatement(true, null);
        this.setColour(230);
        this.setTooltip("Declare a text variable");
        this.setHelpUrl("");
    },
    onchange: function(event) {
        if (event.type === Blockly.Events.BLOCK_CREATE || 
            event.type === Blockly.Events.BLOCK_CHANGE || 
            event.type === Blockly.Events.BLOCK_MOVE) {
            const varName = this.getFieldValue('VAR_NAME');
            const varType = 'TEXT';
            const workspace = this.workspace;
            let variable = workspace.getVariable(varName, varType);
            if (!variable) {
                workspace.createVariable(varName, varType);
            } else if (variable.type !== varType) {
                workspace.deleteVariableById(variable.getId());
                workspace.createVariable(varName, varType);
            }
        }
    }
};

Blockly.Blocks['variables_declare_boolean'] = {
    init: function() {
        this.appendDummyInput()
            .appendField("Declare boolean")
            .appendField(new Blockly.FieldTextInput("myVarBool"), "VAR_NAME")
            .appendField(new Blockly.FieldDropdown([
                ["true", "true"],
                ["false", "false"]
            ]), "TYPE");
        this.setPreviousStatement(true, null);
        this.setNextStatement(true, null);
        this.setColour(160);
        this.setTooltip("Declare a boolean variable");
        this.setHelpUrl("");
    },
    onchange: function(event) {
        if (event.type === Blockly.Events.BLOCK_CREATE || 
            event.type === Blockly.Events.BLOCK_CHANGE || 
            event.type === Blockly.Events.BLOCK_MOVE) {
            const varName = this.getFieldValue('VAR_NAME');
            const varType = 'BOOLEAN';
            const workspace = this.workspace;
            let variable = workspace.getVariable(varName, varType);
            if (!variable) {
                workspace.createVariable(varName, varType);
            } else if (variable.type !== varType) {
                workspace.deleteVariableById(variable.getId());
                workspace.createVariable(varName, varType);
            }
        }
    }
};

//Get
// Obtenção de Variáveis
// Get Number Variable
// Get Number Variable
Blockly.Blocks['variables_get_number'] = {
    init: function() {
        this.appendDummyInput()
            .appendField("Get number")
            .appendField(new Blockly.FieldVariable(
                "myVarText",
                null,
                ['NUMBER'],
                'NUMBER'
            ), "VAR");
        this.setOutput(true, "Number");
        this.setColour(330);
        this.setTooltip("Get the value of a number variable");
        this.setHelpUrl("");
    }
};

// Get Text Variable
Blockly.Blocks['variables_get_text'] = {
    init: function() {
        this.appendDummyInput()
            .appendField("Get text")
            .appendField(new Blockly.FieldVariable(
                "myVarText",
                null,
                ['TEXT'],
                'TEXT'
            ), "VAR");
        this.setOutput(true, "String");
        this.setColour(230);
        this.setTooltip("Get the value of a text variable");
        this.setHelpUrl("");
    }
};

// Get Boolean Variable
Blockly.Blocks['variables_get_boolean'] = {
    init: function() {
        this.appendDummyInput()
            .appendField("Get boolean")
            .appendField(new Blockly.FieldVariable(
                "myVarBool",
                null,
                ['BOOLEAN'],
                'BOOLEAN'
            ), "VAR");
        this.setOutput(true, "Boolean");
        this.setColour(160);
        this.setTooltip("Get the value of a boolean variable");
        this.setHelpUrl("");
    }
};
//END MATH

static/arduino_generator.js:
Blockly.Arduino = new Blockly.Generator('Arduino');

Blockly.Arduino.ORDER_ATOMIC = 0;         // 0 "" ...
Blockly.Arduino.ORDER_UNARY_POSTFIX = 1;  // expr++ expr-- () [] .
Blockly.Arduino.ORDER_UNARY_PREFIX = 2;   // -expr !expr ~expr ++expr --expr
Blockly.Arduino.ORDER_MULTIPLICATIVE = 3; // * / % ~/
Blockly.Arduino.ORDER_ADDITIVE = 4;       // + -
Blockly.Arduino.ORDER_SHIFT = 5;          // << >>
Blockly.Arduino.ORDER_RELATIONAL = 6;     // is is! >= > <= 
Blockly.Arduino.ORDER_EQUALITY = 7;       // == != === !==
Blockly.Arduino.ORDER_BITWISE_AND = 8;    // &
Blockly.Arduino.ORDER_BITWISE_XOR = 9;    // ^
Blockly.Arduino.ORDER_BITWISE_OR = 10;    // |
Blockly.Arduino.ORDER_LOGICAL_AND = 11;   // &&
Blockly.Arduino.ORDER_LOGICAL_OR = 12;    // ||
Blockly.Arduino.ORDER_CONDITIONAL = 13;   // expr ? expr : expr
Blockly.Arduino.ORDER_ASSIGNMENT = 14;    // = += -= *= /= ~/= %= <<= >>= &= ^= |=
Blockly.Arduino.ORDER_YIELD = 15;         // yield
Blockly.Arduino.ORDER_COMMA = 16;         // ,
Blockly.Arduino.ORDER_NONE = 99;          // (...)

Blockly.Arduino.reset = function() {
    Blockly.Arduino.definitions_ = Object.create(null);
    Blockly.Arduino.setups_ = Object.create(null);
    Blockly.Arduino.loop_ = Object.create(null);
};

Blockly.Arduino.init = function(workspace) {
  Blockly.Arduino.nameDB_ = new Blockly.Names(Blockly.Arduino.RESERVED_WORDS_);
  Blockly.Arduino.nameDB_.setVariableMap(workspace.getVariableMap());
  Blockly.Arduino.reset();

  // Create a dictionary of definitions to be printed before setups.
  Blockly.Arduino.definitions_ = Object.create(null);
  // Create a dictionary of setups to be printed before the code.
  Blockly.Arduino.setups_ = Object.create(null);
  // Create a dictionary of variable definitions to be printed after setups.
  Blockly.Arduino.variables_ = Object.create(null);
  // Create a dictionary of functions from the code.
  Blockly.Arduino.functions_ = Object.create(null);
  // Create a dictionary of functions from the header.
  Blockly.Arduino.headerFunctions_ = Object.create(null);
  // Create a dictionary of functions from the user.
  Blockly.Arduino.userFunctions_ = Object.create(null);
  
};

Blockly.Arduino.finish = function(code) {
  // Convert the setups dictionary into a list.
  const setups = [];
  for (const name in Blockly.Arduino.setups_) {
    setups.push(Blockly.Arduino.setups_[name]);
  }
  // Convert the variable definitions dictionary into a list.
  const variables = [];
  for (const name in Blockly.Arduino.variables_) {
    variables.push(Blockly.Arduino.variables_[name]);
  }
  // Convert the functions dictionary into a list.
  const functions = [];
  for (const name in Blockly.Arduino.functions_) {
    functions.push(Blockly.Arduino.functions_[name]);
  }

  // Clean up temporary data.
  delete Blockly.Arduino.definitions_;
  delete Blockly.Arduino.setups_;
  delete Blockly.Arduino.variables_;
  delete Blockly.Arduino.functions_;
  Blockly.Arduino.reset();

  return setups.join('\n') + '\n' + variables.join('\n') + '\n' + functions.join('\n') + '\n\n' + code;
};

Blockly.Arduino.scrub_ = function(block, code) {
  const nextBlock = block.nextConnection && block.nextConnection.targetBlock();
  const nextCode = Blockly.Arduino.blockToCode(nextBlock);
  return code + nextCode;
};

Blockly.Arduino.blockToCode = function(block) {
  if (!block) {
    return '';
  }

  if (block.isEnabled() && !block.hasDisabledReason()) {
    var func = this[block.type];
    if (typeof func !== 'function') {
      throw Error('Language "Arduino" does not know how to generate code for block type "' + block.type + '".');
    }
    var code = func.call(this, block);

    if (Array.isArray(code)) {
      return code;
    } else {
      return [code, Blockly.Arduino.ORDER_NONE];
    }
  } else {
    return this.scrub_(block, '');
  }
};

Blockly.Arduino.workspaceToCode = function(workspace) {
  if (!workspace) {
    console.warn('Blockly.Arduino.workspaceToCode was called with an invalid workspace.');
    return '';
  }
  let code = [];
  this.init(workspace);
  const blocks = workspace.getTopBlocks(true);
  for (let i = 0, block; block = blocks[i]; i++) {
    let line = this.blockToCode(block);
    if (line) {
      if (Array.isArray(line)) {
        line = line[0];
      }
      code.push(line);
    }
  }
  code = code.join('\n');
  code = this.finish(code);
  return code;
};

Blockly.Arduino.prefixLines = function(text, prefix) {
    return prefix + text.replace(/\n/g, '\n' + prefix);
};

Blockly.Arduino['arduino_setup'] = function(block) {
    var statements_setup = Blockly.Arduino.statementToCode(block, 'SETUP');
    statements_setup = Blockly.Arduino.addLoopTrap(statements_setup, block.id) || '';
    statements_setup = Blockly.Arduino.prefixLines(statements_setup, '  ');  // Add indentation
    var code = 'void setup() {\n' + statements_setup + '}\n';
    return code;
};

Blockly.Arduino['arduino_loop'] = function(block) {
    var statements_loop = Blockly.Arduino.statementToCode(block, 'LOOP');
    statements_loop = Blockly.Arduino.addLoopTrap(statements_loop, block.id) || '';
    statements_loop = Blockly.Arduino.prefixLines(statements_loop, '  ');  // Add indentation
    var code = 'void loop() {\n' + statements_loop + '}\n';
    return code;
};



/*
  NATIVES BLOCKS
*/

Blockly.Arduino['controls_if'] = function (block) {
    var n = 0;
    var code = '', branchCode, conditionCode;
    do {
        conditionCode = Blockly.Arduino.valueToCode(block, 'IF' + n, Blockly.Arduino.ORDER_NONE) || 'false';
        branchCode = Blockly.Arduino.statementToCode(block, 'DO' + n);
        code += (n > 0 ? ' else ' : '') + 'if (' + conditionCode + ') {\n' + branchCode + '}';
        n++;
    } while (block.getInput('IF' + n));

    if (block.getInput('ELSE')) {
        branchCode = Blockly.Arduino.statementToCode(block, 'ELSE');
        code += ' else {\n' + branchCode + '}';
    }

    return code + '\n';
};

Blockly.Arduino['logic_compare'] = function (block) {
    var OPERATORS = {
        'EQ': '==',
        'NEQ': '!=',
        'LT': '<',
        'LTE': '<=',
        'GT': '>',
        'GTE': '>='
    };
    var operator = OPERATORS[block.getFieldValue('OP')];
    var order = Blockly.Arduino.ORDER_RELATIONAL;
    var argument0 = Blockly.Arduino.valueToCode(block, 'A', order) || '0';
    var argument1 = Blockly.Arduino.valueToCode(block, 'B', order) || '0';
    var code = argument0 + ' ' + operator + ' ' + argument1;
    return [code, order];
};

Blockly.Arduino['logic_operation'] = function (block) {
    var operator = (block.getFieldValue('OP') === 'AND') ? '&&' : '||';
    var order = (operator === '&&') ? Blockly.Arduino.ORDER_LOGICAL_AND : Blockly.Arduino.ORDER_LOGICAL_OR;
    var argument0 = Blockly.Arduino.valueToCode(block, 'A', order) || 'false';
    var argument1 = Blockly.Arduino.valueToCode(block, 'B', order) || 'false';
    var code = argument0 + ' ' + operator + ' ' + argument1;
    return [code, order];
};

Blockly.Arduino['logic_negate'] = function (block) {
    var order = Blockly.Arduino.ORDER_LOGICAL_NOT;
    var argument0 = Blockly.Arduino.valueToCode(block, 'BOOL', order) || 'false';
    var code = '!' + argument0;
    return [code, order];
};

Blockly.Arduino['logic_boolean'] = function (block) {
    var code = (block.getFieldValue('BOOL') === 'TRUE') ? 'true' : 'false';
    return [code, Blockly.Arduino.ORDER_ATOMIC];
};

Blockly.Arduino['logic_null'] = function (block) {
    return ['NULL', Blockly.Arduino.ORDER_ATOMIC];
};

Blockly.Arduino['logic_ternary'] = function (block) {
    var value_if = Blockly.Arduino.valueToCode(block, 'IF', Blockly.Arduino.ORDER_CONDITIONAL) || 'false';
    var value_then = Blockly.Arduino.valueToCode(block, 'THEN', Blockly.Arduino.ORDER_CONDITIONAL) || 'null';
    var value_else = Blockly.Arduino.valueToCode(block, 'ELSE', Blockly.Arduino.ORDER_CONDITIONAL) || 'null';
    var code = value_if + ' ? ' + value_then + ' : ' + value_else;
    return [code, Blockly.Arduino.ORDER_CONDITIONAL];
};

Blockly.Arduino['controls_repeat_ext'] = function (block) {
    var repeats = Blockly.Arduino.valueToCode(block, 'TIMES', Blockly.Arduino.ORDER_ATOMIC) || '0';
    var branch = Blockly.Arduino.statementToCode(block, 'DO');
    var code = 'for (int count = 0; count < ' + repeats + '; count++) {\n' + branch + '}\n';
    return code;
};

Blockly.Arduino['controls_whileUntil'] = function (block) {
    var until = block.getFieldValue('MODE') === 'UNTIL';
    var argument0 = Blockly.Arduino.valueToCode(block, 'BOOL', until ? Blockly.Arduino.ORDER_LOGICAL_NOT : Blockly.Arduino.ORDER_NONE) || 'false';
    var branch = Blockly.Arduino.statementToCode(block, 'DO');
    if (until) {
        argument0 = '!' + argument0;
    }
    return 'while (' + argument0 + ') {\n' + branch + '}\n';
};

Blockly.Arduino['controls_for'] = function (block) {
    var variable0 = Blockly.Arduino.nameDB_.getName(block.getFieldValue('VAR'), Blockly.VARIABLE_CATEGORY_NAME);
    var argument0 = Blockly.Arduino.valueToCode(block, 'FROM', Blockly.Arduino.ORDER_ASSIGNMENT) || '0';
    var argument1 = Blockly.Arduino.valueToCode(block, 'TO', Blockly.Arduino.ORDER_ASSIGNMENT) || '0';
    var increment = Blockly.Arduino.valueToCode(block, 'BY', Blockly.Arduino.ORDER_ASSIGNMENT) || '1';
    var branch = Blockly.Arduino.statementToCode(block, 'DO');
    var code = 'for (int ' + variable0 + ' = ' + argument0 + '; ' + variable0 + ' <= ' + argument1 + '; ' + variable0;
    code += ' += ' + increment + ') {\n' + branch + '}\n';
    return code;
};

Blockly.Arduino['controls_forEach'] = function (block) {
    var variable0 = Blockly.Arduino.nameDB_.getName(block.getFieldValue('VAR'), Blockly.VARIABLE_CATEGORY_NAME);
    var argument0 = Blockly.Arduino.valueToCode(block, 'LIST', Blockly.Arduino.ORDER_ATOMIC) || '[]';
    var branch = Blockly.Arduino.statementToCode(block, 'DO');
    var code = 'for (int ' + variable0 + ' : ' + argument0 + ') {\n' + branch + '}\n';
    return code;
};

Blockly.Arduino['controls_flow_statements'] = function (block) {
    var xfix = '';
    if (Blockly.Arduino.STATEMENT_PREFIX) {
        xfix += Blockly.Arduino.injectId(Blockly.Arduino.STATEMENT_PREFIX, block);
    }
    if (Blockly.Arduino.STATEMENT_SUFFIX) {
        xfix += Blockly.Arduino.injectId(Blockly.Arduino.STATEMENT_SUFFIX, block);
    }
    if (Blockly.Arduino.STATEMENT_PREFIX) {
        var loop = Blockly.Arduino.nameDB_.getName(block.getFieldValue('LOOP'), Blockly.PROCEDURE_CATEGORY_NAME);
        var code = loop ? 'continue;\n' : 'break;\n';
    } else {
        var code = block.getFieldValue('FLOW') === 'BREAK' ? 'break;\n' : 'continue;\n';
    }
    return xfix + code;
};

// MATH
Blockly.Arduino['math_arithmetic'] = function(block) {
  // Basic arithmetic operators, and power.
  var OPERATORS = {
    'ADD': [' + ', Blockly.Arduino.ORDER_ADDITIVE],
    'MINUS': [' - ', Blockly.Arduino.ORDER_ADDITIVE],
    'MULTIPLY': [' * ', Blockly.Arduino.ORDER_MULTIPLICATIVE],
    'DIVIDE': [' / ', Blockly.Arduino.ORDER_MULTIPLICATIVE],
    'POWER': [null, Blockly.Arduino.ORDER_NONE]  // Handle power separately.
  };
  var tuple = OPERATORS[block.getFieldValue('OP')];
  var operator = tuple[0];
  var order = tuple[1];
  var argument0 = Blockly.Arduino.valueToCode(block, 'A', order) || '0';
  var argument1 = Blockly.Arduino.valueToCode(block, 'B', order) || '0';
  var code;
  // Power in Arduino requires a special case since it has no operator.
  if (!operator) {
    code = 'pow(' + argument0 + ', ' + argument1 + ')';
    return [code, Blockly.Arduino.ORDER_UNARY_POSTFIX];
  }
  code = argument0 + operator + argument1;
  return [code, order];
};

Blockly.Arduino['math_single'] = function (block) {
    var operator = block.getFieldValue('OP');
    var code;
    var arg;
    if (operator === 'NEG') {
        arg = Blockly.Arduino.valueToCode(block, 'NUM', Blockly.Arduino.ORDER_UNARY_NEGATION) || '0';
        code = '-' + arg;
        return [code, Blockly.Arduino.ORDER_UNARY_NEGATION];
    }
    arg = Blockly.Arduino.valueToCode(block, 'NUM', Blockly.Arduino.ORDER_NONE) || '0';
    switch (operator) {
        case 'ROOT':
            code = 'sqrt(' + arg + ')';
            break;
        case 'ABS':
            code = 'abs(' + arg + ')';
            break;
        case 'LN':
            code = 'log(' + arg + ')';
            break;
        case 'EXP':
            code = 'exp(' + arg + ')';
            break;
        case 'POW10':
            code = 'pow(10, ' + arg + ')';
            break;
        default:
            throw Error('Unknown math operator: ' + operator);
    }
    return [code, Blockly.Arduino.ORDER_FUNCTION_CALL];
};

Blockly.Arduino['math_trig'] = function (block) {
    var operator = block.getFieldValue('OP');
    var code;
    var arg;
    if (operator === 'NEG') {
        arg = Blockly.Arduino.valueToCode(block, 'NUM', Blockly.Arduino.ORDER_UNARY_NEGATION) || '0';
        code = '-' + arg;
        return [code, Blockly.Arduino.ORDER_UNARY_NEGATION];
    }
    arg = Blockly.Arduino.valueToCode(block, 'NUM', Blockly.Arduino.ORDER_NONE) || '0';
    switch (operator) {
        case 'SIN':
            code = 'sin(' + arg + ')';
            break;
        case 'COS':
            code = 'cos(' + arg + ')';
            break;
        case 'TAN':
            code = 'tan(' + arg + ')';
            break;
        case 'ASIN':
            code = 'asin(' + arg + ')';
            break;
        case 'ACOS':
            code = 'acos(' + arg + ')';
            break;
        case 'ATAN':
            code = 'atan(' + arg + ')';
            break;
        default:
            throw Error('Unknown math operator: ' + operator);
    }
    return [code, Blockly.Arduino.ORDER_FUNCTION_CALL];
};

Blockly.Arduino['math_constant'] = function (block) {
    var CONSTANTS = {
        'PI': ['PI', Blockly.Arduino.ORDER_ATOMIC],
        'E': ['M_E', Blockly.Arduino.ORDER_ATOMIC],
        'GOLDEN_RATIO': ['1.61803398875', Blockly.Arduino.ORDER_ATOMIC],
        'SQRT2': ['M_SQRT2', Blockly.Arduino.ORDER_ATOMIC],
        'SQRT1_2': ['M_SQRT1_2', Blockly.Arduino.ORDER_ATOMIC]
    };
    return CONSTANTS[block.getFieldValue('CONSTANT')];
};

Blockly.Arduino['math_number_property'] = function (block) {
    var number_to_check = Blockly.Arduino.valueToCode(block, 'NUMBER_TO_CHECK', Blockly.Arduino.ORDER_MODULUS) || '0';
    var dropdown_property = block.getFieldValue('PROPERTY');
    var code;
    if (dropdown_property === 'PRIME') {
        code = 'isPrime(' + number_to_check + ')';
    } else if (dropdown_property === 'EVEN') {
        code = number_to_check + ' % 2 == 0';
    } else if (dropdown_property === 'ODD') {
        code = number_to_check + ' % 2 == 1';
    } else if (dropdown_property === 'WHOLE') {
        code = number_to_check + ' % 1 == 0';
    } else if (dropdown_property === 'POSITIVE') {
        code = number_to_check + ' > 0';
    } else if (dropdown_property === 'NEGATIVE') {
        code = number_to_check + ' < 0';
    } else if (dropdown_property === 'DIVISIBLE_BY') {
        var divisor = Blockly.Arduino.valueToCode(block, 'DIVISOR', Blockly.Arduino.ORDER_MODULUS) || '0';
        code = number_to_check + ' % ' + divisor + ' == 0';
    }
    return [code, Blockly.Arduino.ORDER_LOGICAL_NOT];
};

Blockly.Arduino['math_round'] = function (block) {
    var operator = block.getFieldValue('OP');
    var arg = Blockly.Arduino.valueToCode(block, 'NUM', Blockly.Arduino.ORDER_NONE) || '0';
    var code;
    if (operator === 'ROUND') {
        code = 'round(' + arg + ')';
    } else if (operator === 'ROUNDUP') {
        code = 'ceil(' + arg + ')';
    } else if (operator === 'ROUNDDOWN') {
        code = 'floor(' + arg + ')';
    } else {
        throw Error('Unknown math operator: ' + operator);
    }
    return [code, Blockly.Arduino.ORDER_FUNCTION_CALL];
};

Blockly.Arduino['math_on_list'] = function (block) {
    var func = block.getFieldValue('OP');
    var list = Blockly.Arduino.valueToCode(block, 'LIST', Blockly.Arduino.ORDER_NONE) || '[]';
    var code;
    switch (func) {
        case 'SUM':
            code = list + '.reduce((x, y) => x + y, 0)';
            break;
        case 'MIN':
            code = 'Math.min.apply(null, ' + list + ')';
            break;
        case 'MAX':
            code = 'Math.max.apply(null, ' + list + ')';
            break;
        case 'AVERAGE':
            code = list + '.reduce((x, y) => x + y, 0) / ' + list + '.length';
            break;
        case 'MEDIAN':
            code = 'median(' + list + ')';
            break;
        case 'MODE':
            code = 'mode(' + list + ')';
            break;
        case 'STD_DEV':
            code = 'stdDev(' + list + ')';
            break;
        case 'RANDOM':
            code = list + '[Math.floor(Math.random() * ' + list + '.length)]';
            break;
        default:
            throw Error('Unknown operator: ' + func);
    }
    return [code, Blockly.Arduino.ORDER_FUNCTION_CALL];
};

Blockly.Arduino['math_modulo'] = function (block) {
    var argument0 = Blockly.Arduino.valueToCode(block, 'DIVIDEND', Blockly.Arduino.ORDER_MODULUS) || '0';
    var argument1 = Blockly.Arduino.valueToCode(block, 'DIVISOR', Blockly.Arduino.ORDER_MODULUS) || '0';
    var code = argument0 + ' % ' + argument1;
    return [code, Blockly.Arduino.ORDER_MODULUS];
};

Blockly.Arduino['math_constrain'] = function (block) {
    var argument0 = Blockly.Arduino.valueToCode(block, 'VALUE', Blockly.Arduino.ORDER_NONE) || '0';
    var argument1 = Blockly.Arduino.valueToCode(block, 'LOW', Blockly.Arduino.ORDER_NONE) || '0';
    var argument2 = Blockly.Arduino.valueToCode(block, 'HIGH', Blockly.Arduino.ORDER_NONE) || '0';
    var code = 'constrain(' + argument0 + ', ' + argument1 + ', ' + argument2 + ')';
    return [code, Blockly.Arduino.ORDER_FUNCTION_CALL];
};

Blockly.Arduino['math_random_int'] = function (block) {
    var argument0 = Blockly.Arduino.valueToCode(block, 'FROM', Blockly.Arduino.ORDER_NONE) || '0';
    var argument1 = Blockly.Arduino.valueToCode(block, 'TO', Blockly.Arduino.ORDER_NONE) || '0';
    var code = 'random(' + argument0 + ', ' + argument1 + ')';
    return [code, Blockly.Arduino.ORDER_FUNCTION_CALL];
};

Blockly.Arduino['math_random_float'] = function (block) {
    return ['random(0.0, 1.0)', Blockly.Arduino.ORDER_FUNCTION_CALL];
};

//END MATH

//TEXT
Blockly.Arduino.quote_ = function(string) {
    string = string.replace(/\\/g, '\\\\')
                   .replace(/\n/g, '\\\n')
                   .replace(/'/g, '\\\'');
    return '"' + string + '"';
};

Blockly.Arduino['text'] = function (block) {
    var code = Blockly.Arduino.quote_(block.getFieldValue('TEXT'));
    return [code, Blockly.Arduino.ORDER_ATOMIC];
};

Blockly.Arduino['text_join'] = function (block) {
    var code;
    if (block.itemCount_ === 0) {
        return ['\'\'', Blockly.Arduino.ORDER_ATOMIC];
    } else if (block.itemCount_ === 1) {
        var argument0 = Blockly.Arduino.valueToCode(block, 'ADD0', Blockly.Arduino.ORDER_NONE) || '\'\'';
        code = 'String(' + argument0 + ')';
        return [code, Blockly.Arduino.ORDER_UNARY_POSTFIX];
    } else {
        var argument0 = Blockly.Arduino.valueToCode(block, 'ADD0', Blockly.Arduino.ORDER_NONE) || '\'\'';
        var argument1 = Blockly.Arduino.valueToCode(block, 'ADD1', Blockly.Arduino.ORDER_NONE) || '\'\'';
        code = 'String(' + argument0 + ') + String(' + argument1 + ')';
        for (var n = 2; n < block.itemCount_; n++) {
            argument1 = Blockly.Arduino.valueToCode(block, 'ADD' + n, Blockly.Arduino.ORDER_NONE) || '\'\'';
            code = code + ' + String(' + argument1 + ')';
        }
        return [code, Blockly.Arduino.ORDER_UNARY_POSTFIX];
    }
};

Blockly.Arduino['text_append'] = function (block) {
    var varName = Blockly.Arduino.nameDB_.getName(block.getFieldValue('VAR'), Blockly.VARIABLE_CATEGORY_NAME);
    var argument0 = Blockly.Arduino.valueToCode(block, 'TEXT', Blockly.Arduino.ORDER_NONE) || '\'\'';
    return varName + ' += ' + argument0 + ';\n';
};

Blockly.Arduino['text_length'] = function (block) {
    var argument0 = Blockly.Arduino.valueToCode(block, 'VALUE', Blockly.Arduino.ORDER_UNARY_POSTFIX) || '\'\'';
    return [argument0 + '.length()', Blockly.Arduino.ORDER_UNARY_POSTFIX];
};

Blockly.Arduino['text_isEmpty'] = function (block) {
    var argument0 = Blockly.Arduino.valueToCode(block, 'VALUE', Blockly.Arduino.ORDER_UNARY_POSTFIX) || '\'\'';
    return [argument0 + '.isEmpty()', Blockly.Arduino.ORDER_UNARY_POSTFIX];
};

Blockly.Arduino['text_indexOf'] = function (block) {
    var operator = block.getFieldValue('END') === 'FIRST' ? 'indexOf' : 'lastIndexOf';
    var argument0 = Blockly.Arduino.valueToCode(block, 'FIND', Blockly.Arduino.ORDER_NONE) || '\'\'';
    var argument1 = Blockly.Arduino.valueToCode(block, 'VALUE', Blockly.Arduino.ORDER_UNARY_POSTFIX) || '\'\'';
    var code = argument1 + '.' + operator + '(' + argument0 + ')';
    return [code, Blockly.Arduino.ORDER_UNARY_POSTFIX];
};

Blockly.Arduino['text_charAt'] = function (block) {
    var where = block.getFieldValue('WHERE') || 'FROM_START';
    var textOrder = (where === 'RANDOM') ? Blockly.Arduino.ORDER_NONE : Blockly.Arduino.ORDER_UNARY_POSTFIX;
    var text = Blockly.Arduino.valueToCode(block, 'VALUE', textOrder) || '\'\'';
    var code;
    if (where === 'FIRST') {
        code = text + '.charAt(0)';
        return [code, Blockly.Arduino.ORDER_UNARY_POSTFIX];
    } else if (where === 'LAST') {
        code = text + '.charAt(' + text + '.length() - 1)';
        return [code, Blockly.Arduino.ORDER_UNARY_POSTFIX];
    } else if (where === 'FROM_START') {
        var at = Blockly.Arduino.getAdjusted(block, 'AT');
        code = text + '.charAt(' + at + ')';
        return [code, Blockly.Arduino.ORDER_UNARY_POSTFIX];
    } else if (where === 'FROM_END') {
        var at = Blockly.Arduino.getAdjusted(block, 'AT', 1, true);
        code = text + '.charAt(' + text + '.length() - ' + at + ')';
        return [code, Blockly.Arduino.ORDER_UNARY_POSTFIX];
    } else if (where === 'RANDOM') {
        var functionName = Blockly.Arduino.provideFunction_(
            'textRandomLetter',
            ['String ' + Blockly.Arduino.FUNCTION_NAME_PLACEHOLDER_ + '(String text) {',
                '  int x = random(text.length());',
                '  return text.charAt(x);',
                '}']);
        code = functionName + '(' + text + ')';
        return [code, Blockly.Arduino.ORDER_UNARY_POSTFIX];
    }
    throw Error('Unhandled option (text_charAt).');
};

Blockly.Arduino['text_getSubstring'] = function (block) {
    var text = Blockly.Arduino.valueToCode(block, 'STRING', Blockly.Arduino.ORDER_UNARY_POSTFIX) || '\'\'';
    var where1 = block.getFieldValue('WHERE1');
    var where2 = block.getFieldValue('WHERE2');
    var at1 = Blockly.Arduino.valueToCode(block, 'AT1', Blockly.Arduino.ORDER_NONE) || '1';
    var at2 = Blockly.Arduino.valueToCode(block, 'AT2', Blockly.Arduino.ORDER_NONE) || '1';
    var code;
    if (where1 === 'FROM_END') {
        at1 = text + '.length() - ' + at1;
    } else if (where1 === 'FIRST') {
        at1 = '0';
    }
    if (where2 === 'FROM_END') {
        at2 = text + '.length() - ' + at2 + ' + 1';
    } else if (where2 === 'LAST') {
        at2 = text + '.length()';
    }
    code = text + '.substring(' + at1 + ', ' + at2 + ')';
    return [code, Blockly.Arduino.ORDER_UNARY_POSTFIX];
};

Blockly.Arduino['text_changeCase'] = function (block) {
    var operator = block.getFieldValue('CASE');
    var argument0 = Blockly.Arduino.valueToCode(block, 'TEXT', Blockly.Arduino.ORDER_UNARY_POSTFIX) || '\'\'';
    var code;
    if (operator === 'UPPERCASE') {
        code = argument0 + '.toUpperCase()';
    } else if (operator === 'LOWERCASE') {
        code = argument0 + '.toLowerCase()';
    } else if (operator === 'TITLECASE') {
        var functionName = Blockly.Arduino.provideFunction_(
            'textToTitleCase',
            ['String ' + Blockly.Arduino.FUNCTION_NAME_PLACEHOLDER_ + '(String str) {',
                '  return str.toLowerCase().replace(/\\b\\w/g, function (m) {return m.toUpperCase();});',
                '}']);
        code = functionName + '(' + argument0 + ')';
    }
    return [code, Blockly.Arduino.ORDER_UNARY_POSTFIX];
};

Blockly.Arduino['text_trim'] = function (block) {
    var OPERATORS = {
        'LEFT': '.trimStart()',
        'RIGHT': '.trimEnd()',
        'BOTH': '.trim()'
    };
    var operator = OPERATORS[block.getFieldValue('MODE')];
    var argument0 = Blockly.Arduino.valueToCode(block, 'TEXT', Blockly.Arduino.ORDER_UNARY_POSTFIX) || '\'\'';
    return [argument0 + operator, Blockly.Arduino.ORDER_UNARY_POSTFIX];
};

Blockly.Arduino['text_print'] = function(block) {
    var mode = block.getFieldValue('MODE');
    var argument0 = Blockly.Arduino.valueToCode(block, 'TEXT', Blockly.Arduino.ORDER_NONE) || '""';

    // Verificar se o value é um array e pegar o primeiro elemento
    if (Array.isArray(argument0)) {
        argument0 = argument0[0];
    }

    // Remover caracteres indesejados
    if (typeof argument0 === 'string') {
        argument0 = argument0.replace(/[()]/g, '');
    }

    if (mode === 'PRINTLN') {
        return 'Serial.println(' + argument0 + ');\n';
    } else {
        return 'Serial.print(' + argument0 + ');\n';
    }
};

Blockly.Arduino['text_prompt_ext'] = function (block) {
    var msg = Blockly.Arduino.quote_(block.getFieldValue('TEXT'));
    var code = 'Serial.println(' + msg + ');\n';
    return code;
};
//END TEXT

Blockly.Arduino['lists_create_with'] = function (block) {
    var code = new Array(block.itemCount_);
    for (var n = 0; n < block.itemCount_; n++) {
        code[n] = Blockly.Arduino.valueToCode(block, 'ADD' + n, Blockly.Arduino.ORDER_NONE) || 'null';
    }
    code = '[' + code.join(', ') + ']';
    return [code, Blockly.Arduino.ORDER_ATOMIC];
};

Blockly.Arduino['lists_repeat'] = function (block) {
    var argument0 = Blockly.Arduino.valueToCode(block, 'ITEM', Blockly.Arduino.ORDER_NONE) || 'null';
    var argument1 = Blockly.Arduino.valueToCode(block, 'NUM', Blockly.Arduino.ORDER_NONE) || '0';
    var code = 'Array(' + argument1 + ').fill(' + argument0 + ')';
    return [code, Blockly.Arduino.ORDER_ATOMIC];
};

Blockly.Arduino['lists_length'] = function (block) {
    var argument0 = Blockly.Arduino.valueToCode(block, 'VALUE', Blockly.Arduino.ORDER_UNARY_POSTFIX) || '[]';
    return [argument0 + '.length', Blockly.Arduino.ORDER_UNARY_POSTFIX];
};

Blockly.Arduino['lists_isEmpty'] = function (block) {
    var argument0 = Blockly.Arduino.valueToCode(block, 'VALUE', Blockly.Arduino.ORDER_UNARY_POSTFIX) || '[]';
    return ['!' + argument0 + '.length', Blockly.Arduino.ORDER_LOGICAL_NOT];
};

Blockly.Arduino['lists_indexOf'] = function (block) {
    var argument0 = Blockly.Arduino.valueToCode(block, 'FIND', Blockly.Arduino.ORDER_NONE) || '\'\'';
    var argument1 = Blockly.Arduino.valueToCode(block, 'VALUE', Blockly.Arduino.ORDER_UNARY_POSTFIX) || '[]';
    var code = argument1 + '.indexOf(' + argument0 + ')';
    return [code, Blockly.Arduino.ORDER_UNARY_POSTFIX];
};

Blockly.Arduino['lists_getIndex'] = function (block) {
    var mode = block.getFieldValue('MODE') || 'GET';
    var where = block.getFieldValue('WHERE') || 'FROM_START';
    var listOrder = (where === 'RANDOM') ? Blockly.Arduino.ORDER_NONE : Blockly.Arduino.ORDER_UNARY_POSTFIX;
    var list = Blockly.Arduino.valueToCode(block, 'VALUE', listOrder) || '[]';
    var code;
    if (where === 'FIRST') {
        code = list + '[0]';
    } else if (where === 'LAST') {
        code = list + '[' + list + '.length - 1]';
    } else if (where === 'FROM_START') {
        var at = Blockly.Arduino.getAdjusted(block, 'AT');
        code = list + '[' + at + ']';
    } else if (where === 'FROM_END') {
        var at = Blockly.Arduino.getAdjusted(block, 'AT', 1, true);
        code = list + '[' + list + '.length - ' + at + ']';
    } else if (where === 'RANDOM') {
        var functionName = Blockly.Arduino.provideFunction_(
            'listsGetRandomItem',
            ['function ' + Blockly.Arduino.FUNCTION_NAME_PLACEHOLDER_ + '(list, remove) {',
                '  var x = Math.floor(Math.random() * list.length);',
                '  if (remove) {',
                '    return list.splice(x, 1)[0];',
                '  } else {',
                '    return list[x];',
                '  }',
                '}']);
        code = functionName + '(' + list + ', ' + (mode !== 'GET') + ')';
    }
    if (mode === 'GET') {
        return [code, Blockly.Arduino.ORDER_UNARY_POSTFIX];
    } else if (mode === 'GET_REMOVE') {
        return [code, Blockly.Arduino.ORDER_UNARY_POSTFIX];
    } else if (mode === 'REMOVE') {
        return code + ';\n';
    }
    throw Error('Unhandled combination (lists_getIndex).');
};

Blockly.Arduino['lists_setIndex'] = function (block) {
    var list = Blockly.Arduino.valueToCode(block, 'LIST', Blockly.Arduino.ORDER_ASSIGNMENT) || '[]';
    var mode = block.getFieldValue('MODE') || 'SET';
    var where = block.getFieldValue('WHERE') || 'FROM_START';
    var value = Blockly.Arduino.valueToCode(block, 'TO', Blockly.Arduino.ORDER_ASSIGNMENT) || 'null';
    var code;
    if (where === 'FIRST') {
        code = list + '[0]';
    } else if (where === 'LAST') {
        code = list + '[' + list + '.length - 1]';
    } else if (where === 'FROM_START') {
        var at = Blockly.Arduino.getAdjusted(block, 'AT');
        code = list + '[' + at + ']';
    } else if (where === 'FROM_END') {
        var at = Blockly.Arduino.getAdjusted(block, 'AT', 1, true);
        code = list + '[' + list + '.length - ' + at + ']';
    } else if (where === 'RANDOM') {
        var functionName = Blockly.Arduino.provideFunction_(
            'listsGetRandomItem',
            ['function ' + Blockly.Arduino.FUNCTION_NAME_PLACEHOLDER_ + '(list) {',
                '  var x = Math.floor(Math.random() * list.length);',
                '  return x;',
                '}']);
        code = functionName + '(' + list + ')';
    }
    if (mode === 'SET') {
        return list + '[' + code + '] = ' + value + ';\n';
    } else if (mode === 'INSERT') {
        return list + '.splice(' + code + ', 0, ' + value + ');\n';
    }
    throw Error('Unhandled combination (lists_setIndex).');
};

Blockly.Arduino['lists_getSublist'] = function (block) {
    var list = Blockly.Arduino.valueToCode(block, 'LIST', Blockly.Arduino.ORDER_UNARY_POSTFIX) || '[]';
    var where1 = block.getFieldValue('WHERE1');
    var where2 = block.getFieldValue('WHERE2');
    var at1 = Blockly.Arduino.valueToCode(block, 'AT1', Blockly.Arduino.ORDER_NONE) || '1';
    var at2 = Blockly.Arduino.valueToCode(block, 'AT2', Blockly.Arduino.ORDER_NONE) || '1';
    var code;
    if (where1 === 'FROM_END') {
        at1 = list + '.length - ' + at1;
    } else if (where1 === 'FIRST') {
        at1 = '0';
    }
    if (where2 === 'FROM_END') {
        at2 = list + '.length - ' + at2 + ' + 1';
    } else if (where2 === 'LAST') {
        at2 = list + '.length';
    }
    code = list + '.slice(' + at1 + ', ' + at2 + ')';
    return [code, Blockly.Arduino.ORDER_UNARY_POSTFIX];
};

Blockly.Arduino['lists_split'] = function (block) {
    var input = Blockly.Arduino.valueToCode(block, 'INPUT', Blockly.Arduino.ORDER_UNARY_POSTFIX) || '\'\'';
    var delimiter = Blockly.Arduino.valueToCode(block, 'DELIM', Blockly.Arduino.ORDER_NONE) || '\'\'';
    var mode = block.getFieldValue('MODE');
    if (mode === 'SPLIT') {
        var code = input + '.split(' + delimiter + ')';
    } else if (mode === 'JOIN') {
        var code = input + '.join(' + delimiter + ')';
    }
    return [code, Blockly.Arduino.ORDER_UNARY_POSTFIX];
};

Blockly.Arduino['lists_sort'] = function (block) {
    var list = Blockly.Arduino.valueToCode(block, 'LIST', Blockly.Arduino.ORDER_UNARY_POSTFIX) || '[]';
    var direction = block.getFieldValue('DIRECTION') === '1' ? '1' : '-1';
    var type = block.getFieldValue('TYPE');
    var getCompareFunctionName = Blockly.Arduino.provideFunction_(
        'listsGetSortCompare',
        ['function ' + Blockly.Arduino.FUNCTION_NAME_PLACEHOLDER_ + '(type, direction) {',
            '  var compare = function (a, b) {',
            '    if (a < b) return -1 * direction;',
            '    if (a > b) return 1 * direction;',
            '    return 0;',
            '  };',
            '  return compare;',
            '}']);
    var code = list + '.slice().sort(' + getCompareFunctionName + '("' + type + '", ' + direction + '))';
    return [code, Blockly.Arduino.ORDER_UNARY_POSTFIX];
};

Blockly.Arduino['math_number'] = function(block) {
  const code = String(block.getFieldValue('NUM'));
  return [code, Blockly.Arduino.ORDER_ATOMIC]
};

Blockly.FieldVariable.prototype.getVariableList = function(opt_type) {
    var variableModelList = this.workspace.getVariablesOfType(opt_type || '');
    variableModelList.sort((a, b) => a.name.localeCompare(b.name, undefined, { sensitivity: 'base' }));
    var variableNames = variableModelList.map(variable => [variable.name, variable.getId()]);
    return variableNames;
};

// Geradores de Variáveis
Blockly.Arduino['variables_declare_number'] = function(block) {
    var varName = block.getFieldValue('VAR_NAME');
    var type = block.getFieldValue('TYPE');
    var value = Blockly.Arduino.valueToCode(block, 'VALUE', Blockly.Arduino.ORDER_ATOMIC) || '0';

    if (typeof value[0] === 'string') {
        value = value[0].replace(/[()]/g, '');
    }

    var code = type + ' ' + varName + ' = ' + value + ';\n';
    Blockly.Arduino.definitions_['var_' + varName] = code;
    return code;
};

Blockly.Arduino['variables_declare_text'] = function(block) {
    var varName = block.getFieldValue('VAR_NAME');
    var type = block.getFieldValue('TYPE');
    var value = Blockly.Arduino.valueToCode(block, 'VALUE', Blockly.Arduino.ORDER_ATOMIC) || '""';

    if (typeof value[0] === 'string') {
        value = value[0].replace(/[()]/g, '');
    }

    if (type === 'char') {
        var arraySize = 15;
        if (value.includes(',')) {
            value = '{' + value + '}';
        } else if (value.includes('"')) {
            arraySize = Math.max(arraySize, value.length - 2 + 1);
        }
        var code = type + ' ' + varName + '[' + arraySize + '] = ' + value + ';\n';
    } else {
        var code = type + ' ' + varName + ' = ' + value + ';\n';
    }

    Blockly.Arduino.definitions_['var_' + varName] = code;
    return code;
};

Blockly.Arduino['variables_declare_boolean'] = function(block) {
    var varName = block.getFieldValue('VAR_NAME');
    var value = block.getFieldValue('TYPE');
    var code = 'bool ' + varName + ' = ' + value + ';\n';
    Blockly.Arduino.definitions_['var_' + varName] = code;
    return code;
};

//Get
// Gerador de código para obter variáveis do tipo número
Blockly.Arduino['variables_get_number'] = function(block) {
    var varName = Blockly.Arduino.nameDB_.getName(block.getFieldValue('VAR'), Blockly.Names.NameType.VARIABLE);
    return [varName, Blockly.Arduino.ORDER_ATOMIC];
};

// Gerador de código para obter variáveis do tipo texto
Blockly.Arduino['variables_get_text'] = function(block) {
    var varName = Blockly.Arduino.variableDB_.getName(block.getFieldValue('VAR'), Blockly.Variables.NAME_TYPE);
    return [varName, Blockly.Arduino.ORDER_ATOMIC];
};


// Gerador de código para obter variáveis do tipo booleano
Blockly.Arduino['variables_get_boolean'] = function(block) {
    var varName = Blockly.Arduino.variableDB_.getName(block.getFieldValue('VAR'), Blockly.Variables.NAME_TYPE);
    return [varName, Blockly.Arduino.ORDER_ATOMIC];
};


// Geradores de Funções
Blockly.Arduino['procedures_defreturn'] = function(block) {
  const funcName = Blockly.Arduino.variableDB_.getName(block.getFieldValue('NAME'), Blockly.PROCEDURE_CATEGORY_NAME);
  const branch = Blockly.Arduino.statementToCode(block, 'STACK');
  const returnValue = Blockly.Arduino.valueToCode(block, 'RETURN', Blockly.Arduino.ORDER_NONE) || '';
  const returnType = returnValue ? 'int' : 'void';
  const code = returnType + ' ' + funcName + '() {\n' + branch + (returnValue ? '  return ' + returnValue + ';\n' : '') + '}\n';
  Blockly.Arduino.definitions_[funcName] = code;
  return null;
};

Blockly.Arduino['procedures_defnoreturn'] = function(block) {
  const funcName = Blockly.Arduino.variableDB_.getName(block.getFieldValue('NAME'), Blockly.PROCEDURE_CATEGORY_NAME);
  const branch = Blockly.Arduino.statementToCode(block, 'STACK');
  const code = 'void ' + funcName + '() {\n' + branch + '}\n';
  Blockly.Arduino.definitions_[funcName] = code;
  return null;
};

Blockly.Arduino['procedures_callreturn'] = function(block) {
  const funcName = Blockly.Arduino.variableDB_.getName(block.getFieldValue('NAME'), Blockly.PROCEDURE_CATEGORY_NAME);
  const args = [];
  for (let i = 0; i < block.arguments_.length; i++) {
    args[i] = Blockly.Arduino.valueToCode(block, 'ARG' + i, Blockly.Arduino.ORDER_NONE) || 'null';
  }
  const code = funcName + '(' + args.join(', ') + ')';
  return [code, Blockly.Arduino.ORDER_FUNCTION_CALL];
};

Blockly.Arduino['procedures_callnoreturn'] = function(block) {
  const funcName = Blockly.Arduino.variableDB_.getName(block.getFieldValue('NAME'), Blockly.PROCEDURE_CATEGORY_NAME);
  const args = [];
  for (let i = 0; i < block.arguments_.length; i++) {
    args[i] = Blockly.Arduino.valueToCode(block, 'ARG' + i, Blockly.Arduino.ORDER_NONE) || 'null';
  }
  const code = funcName + '(' + args.join(', ') + ');\n';
  return code;
};

Blockly.Arduino['procedures_ifreturn'] = function(block) {
  const condition = Blockly.Arduino.valueToCode(block, 'CONDITION', Blockly.Arduino.ORDER_NONE) || 'false';
  let code = 'if (' + condition + ') {\n';
  if (block.hasReturnValue_) {
    const value = Blockly.Arduino.valueToCode(block, 'VALUE', Blockly.Arduino.ORDER_NONE) || 'null';
    code += '  return ' + value + ';\n';
  } else {
    code += '  return;\n';
  }
  code += '}\n';
  return code;
};

Blockly.Generator.prototype.valueToCode = function(block, name, outerOrder) {
  if (isNaN(outerOrder)) {
    throw Error('Expecting valid order from block: ' + block);
  }
  var targetBlock = block.getInputTargetBlock(name);
  if (!targetBlock) {
    return ['', Blockly.Generator.ORDER_ATOMIC];
  }
  var tuple = this.blockToCode(targetBlock);
  if (!Array.isArray(tuple)) {
    throw TypeError('Expecting tuple from value block: ' + targetBlock.type);
  }
  var code = tuple[0];
  var innerOrder = tuple[1];
  if (isNaN(innerOrder)) {
    throw Error('Expecting valid order from value block: ' + targetBlock.type);
  }
  if (code && outerOrder <= innerOrder) {
    code = '(' + code + ')';
  }
  return [code, innerOrder];
};

Blockly.Generator.prototype.statementToCode = function(block, name) {
    var targetBlock = block.getInputTargetBlock(name);
    if (!targetBlock) {
        return ''; // If there's no block, return empty string
    }
    var code = this.blockToCode(targetBlock);
    if (!Array.isArray(code)) {
        throw new Error('Expecting code from statement block: ' + (targetBlock && targetBlock.type));
    }
    return code[0];
};


static/custom_generators.js:
// static/custom_generators.js

Blockly.Msg.LOGIC_HUE = '210'; // Ajuste a cor conforme necessário
Blockly.Msg.LOOPS_HUE = '120'; // Ajuste a cor conforme necessário
Blockly.Msg.MATH_HUE = '230'; // Ajuste a cor conforme necessário
Blockly.Msg.TEXTS_HUE = '160'; // Ajuste a cor conforme necessário
Blockly.Msg.LISTS_HUE = '260'; // Ajuste a cor conforme necessário
Blockly.Msg.COLOUR_HUE = '20'; // Ajuste a cor conforme necessário
Blockly.Msg.VARIABLES_HUE = '330'; // Ajuste a cor conforme necessário
Blockly.Msg.PROCEDURES_HUE = '290'; // Ajuste a cor conforme necessário

Blockly.BlockSvg.START_HAT = true;
Blockly.BlockSvg.prototype.updateColour = function() {
  var colourHex = this.getColour();
  this.svgPath_.setAttribute('fill', colourHex);
  this.svgPath_.setAttribute('stroke', Blockly.utils.colour.darken(colourHex, 0.2));
  var inputList = this.inputList;
  for (var i = 0, input; input = inputList[i]; i++) {
    var fieldList = input.fieldRow;
    for (var j = 0, field; field = fieldList[j]; j++) {
      if (field instanceof Blockly.FieldLabel) {
        field.setText(field.getText());
      }
    }
  }
};

Blockly.FieldLabel.prototype.setText = function(text) {
  if (this.textElement_) {
    this.text_ = text;
    this.textElement_.textContent = text;
    this.textElement_.style.fontWeight = 'bold';
    this.textElement_.style.fill = '#FFFFFF';
  }
};


static/favicon.ico:
           +     PNG

   IHDR         \rf   orNTϢw  +;IDATxxTCzo$!	!{Fi
R *MD"(
V"JGAEł|s]Lewnyߓ'{=SΜqqq)PlF]PAY0UTFB`lFQ\<ł?6_l
`:876[	X=pcJ{Ypp:pNnmZ`NՍ9>nnNmLի`OjVVwS4 lΪ虪5CH
6i4vI\Sb0Z)Tgo FigژNM6! 6PvwJsܨ=ԤE7 
,3eD`Qr(QK	.NR%, 7Ӣ;#V<x,0N=3sB[GU
~S wwZV=Y:~VvC&9ͺЅt&l1Ԏyyn>GqUMñqF޸É-w|uyJ鉴ېݨrJE ~dqjɊzT<v:vRs	?AQ?kk5
N8rU_ EcܚT+W+{I8
1H^> $VħiWIQ<hż^4*eWj!ii/mmD&?/>VN&V+`<=gquCXa_j^:!<^<|R?[ZƤ9ݬ4j&l6CR,ǱV uhy|¦60Jus.1<x	V(UG1WHWVU:߰U/4Z
k`oMiN%=R*xDWK.	D<:mm2Ѓg"vwp}vu%Ւ IVbwbGmzQXRk(TCXyc
a	RySU]-:\W [zZmi/ ޯJB|9`5+}Rlj+w#	yz)}ckߦNcyl-cir(A?7E wZ -m6@ |( `C᷶R4Wf`n+6!ُ屇.xl1RyjZoI+KM]6@!
YfЄT;(Dے+{UsZT78Uv+Ek7R<f4j<hrv]h~L^di^Z:b2,E({_ꂠݙ (D0-x<<૽u5-<Fw,Ohj?h4./iiېc5 ;~;ȱZX  v$  چy{,3N`P胄 k ,Oce@.,yF2-[<  
1XX w@4    
 @ P    a   ;nnnTN2؅t$vz! %]A)iC + ^4sBi	):~G:ug:u 쏷i <`1?E{'/
.' vɥw
 XM  ;yp K߁ @      f ED <A΂IiVb`ʶ` pLi}k5lK``  '_^6@['!#0M SAp@!@n6psJ^pQ٨L/wd|3_ ;7$}ۚ%0@a7qӎ  y$9jSZah@ 5y`-w`?t*etӛ6=krLY0T 0zjE`ڿ=/wm,Jw_*ٰc}m._;DGϚ"x[~gywWK7uvv. ]rN\OpEŊ0DUUkQ:T*6lsRLbcJj")؈|CJ8l`'TmؓAزEi)W"а0SR(I3ZZswz5ސJ,{^gkjс>ڼM%' >T&}7Pdt
\|¨v>B2~M>Tz=mٓ;]QB2{Mf?*p86Bu);?s!^)`!*TLk:[.뗿h-UȯY6m{Ֆ 'l~}?)u`&N|iA~(jF-QC˟ހ**	 gwQX	KpHt, ~yoC#Ag<@k' I֢۪7yY$CdT.U( }ӎ* l s_"J^#!`A@67eMoeq-jץܵ?.Ut>50`ڗ.Sjtd$v{\6}I ̈9z_T䑾skV{-S;S|)3lp{s_|.[ )VwhAW7*[9%tn5HzhL q;h4|x7LrL>)fx3/$=+M_IhĘ	;ؕ,t/	aqתSW/Cv"/ [vf'c FF0h6Ui܍\Sq1D	5`/_|ǨF&(%v:='HU ;upqA- pMW!~3(wxr
,4,zJ.}~k )|GӴ9~TF>fRm7~W~lԬ$?g]k%ץAGG5Z. fjvO=}]Oyߏb[R (WRL"(DE灻6 vc1@ޑROO{;;YsT\R|9y9%Jm;vO?p*KS}{œÝsM:speْo Ϫ+9H-hEn}j{+@!Fsij75uzA#Fcy
poHaQ;6Qvw\voY u&-*kCf*
@M	) 9T$ ;gChk\أuo(~ۇR1t9yyyi^3>1VBk;0juiS(`HWHͰZCԴU	]-{Cqt[dب1~Fct͂vٛ 
gF ʧY+`T^}kyyӐQc5ҏ{J<Z[P2Pt{5! SqL! JFq5tHc&OJFZɉSS%:V^8O\	]c	@1WwrS_o^|
PNˎuAշ@\Pԅ~WX'Yx8 #s	U_0GJ jSSlswY*YE ؁ّ3a%t-\y<_)MZ}.-zMA*1r5ڛǹy_~g@`T/gPZJrϺ)3SsREyw)<{@_Ar^bJEob[.yl9yғ,BWjݾ>1G!G6%HLK ;Sܿ}A>?gۚR&WsߨBCxB|	q^Qm8?xF%<y&8}z#`6|ǤeU<`04|x9#f	߉</(<jt (	r6onr0!|<8b9'
輁x샻6Xc}e9bx:q'@ ( W}&pOyKϜHUd8QķnNSpvK&		-c)&0
!o_Z[k>QmA l( \ً^K7Ҏp.cр.z^ܣAյ,2Qȋv^+>Z'g",^ ܕ}3$={ KGM9^Ceޓ.yLF݁4)d[lxn 8i1# { &g>[?8̖껟n?(U6}bqpvugZmĿ8EuSHxɒfVձ8^9:FE! ?35Gg]H\;۶S.!] Z_~]Uh$2 ̈ws64k(B9TV/^͙+ϝmMN=K?h2pǹFO;	)vDḩi,`1$z/@! ?SeEy܀Li1;;N*VT}Uf7${e**W=2>## XSP`tT渞CqGGeS2}^o`NÌ	6gE]` 3Y\E%Y}>t\yxn1zKw'&LTP1x+眑#  0q5 ;>q</1%;nMUGI64ڦr"ouEb! `^> vvܡOUmK5*|C-4tu|#@"DrnR&C   f0p٩T54
d3R)jq BK2ƍ<+
w~
 7%7yS{W*j}ぷS==dl\@&t%8? `F\LR̗X[9x[ϜPu81,S=rg7u1)iQԁ֏IIc  % ٻ
t}*-d'[k r_|3-lIn%w+]hރ>;#~KKS?<!PH#VQJdi@켼Zl>u0
VM!ⲷ霕XI;,*vl7ƹ WL03}e;"U ;&k&}ȼZ4DmQi1g+~uf:cJ2wQӟ\L'$ ع Ou*Kor^푞_xr$-xeI|N{	$$Ցyw[u~Ƣ"p3vL597ȱ,v\ϛ>F/4:1ZrRhN/(p7<ug=s:??"/ joWT9erVGS 8 (mvmI'I3:rMws74i~W,`ܝ9w`xp $䤜^F_W_lr1sTxg%޻A)a
sK/ KF[.: 7Tˬˉ_gYm<ʺFS~RRX\5ZD˨}YϫpwoĩrHުͤGPB:ǥm`;W
\_No,gYs1p^Es7l{px
/8$T2:uc/BAA U$0slEo
\D ٴe?!ϲ?Z D}m8}]S  A@giÎ=tp~ (
`]aD@       }nνg|a0! 6 2X3ɱ4`pa'2,^d3yC}Gg^&lNr8ؼ#ՌkoSاnP+`:˖ؼ9Wq#d8a l
\=':qM;snRk? h'?	ˁE O,UTiڲ`x;e:cWo"B:aB#^`XZgr)tc75y"7ݲGxFMdm[q>B8aۊ*KiƢ@ 
aq9/Ii qSf?K//Wnh5\Ug;::٦,ZBwݦPH$e=d0])Z C               @      7ԼP ~8G/ݔlu@n÷tҹ6={\u/ۖ)@ 
!_QT:"J Vl
Գ@q⛏v$2C2p`jծ}e"f1a?GzоKw<FoqSgHk֪-mN% r-n@NuH~|!gQsb9dt`pԂo] ^da!# {rwe@pdM^k鋲9\mm- ;I
_7jZkܨcĵ[_ϾLElklsH
jG <('(v2UUDSXJIk@fdwg/Oдek9u:6Ŷ6ƶY ;<{Iy_D=pk\0`3Ag-1q( A>Yzw7>  X       @      @      hyO˕j	_#Ko7
:x! 	xʏ54d5``P`:j,އ{?KO?"2fZ:~GDZl}6B<1<*c9k1^}% /~sGuvPph]t2r461r'O,t3i;.{rA9~ۋ <Ԡq86lJ%K17oS\%6~,ruu8lklsY, 9EFZ	c\ZQӜY/CQ`P[(6ƶ(i@p۰cP3y<zv˴ZӀK~ǟѬy@<oa[녍i=o@!F@/d#Zz!]ὁ{  ^Bc. ! 9`_T2is' ' ܄  ; RX2R/; #EQǞxRS7~n>5Q05HED3VW(;'ah16kV՞+͔6& 5<L/,]~pU۷?* lO  `,-zuShW;e_ap NްisU;fOzA< 8E6!cF.~n) [-KrH/&Q_g@	՛MMoHK\I>!(4nߕKl35nJٶG0_T@ʤЍU6hLzr). f52J}n^Bn#ӇK7 4_eڎ~~2  ^lu'66wHY<NWHh50w8ph.Cq}޷ 06S-p	 p)6<`T!pA<y eHw}ISwhy`h`d,U/Y.pkl/=NNRlT8*Q!qVR 6mmm1
Ze5{`^@V0Mis~62ؤ *Bc  P                                                            PʔTMyҟ^d Yp/ ePlrCĸ>GƣR![)  S"|gUoP՝ܼ;oށ  	)a      
| 
7Om6ǴxD  J_tB5 @dހ9@@P`*ܒBFS@(AMSPd% @>	LU(郔oZ^/h0v;5()u{OL ~D ̤N~
  .@          PDȔ#'  σO5Q9O>"  8
G^>X- `ps=p	z)i  0`.r-8 <& i @ P9su+*-  8qhX@h٘lk9P Kqx(6xI&\
*'a[F9qU8h8C
-/{Rt* ! 6{nr??98֬Pb\E  \UK4ȹxZZo&<Fd)1ؖ=e@]^9A8	 -7` 6aLݧ0_ O Ҹ  pkn)x0 1y, ?PlFXKF7 v%@3) 2TAG,)}ʛ XAeQQoj3MxaHHTU*HVL`!Jr1M_ Vz%_)XczWlOܴbrG󅧗 `Oq]>a X@pSrLSv p*ا\L,/
Py 8./|ڬ)hn0$* oϾ-h!rGW3Dll6cښ&2*SSz6Y&J vl2VϯA (5nnnSSGhl_k&_[E vb[;qAqkXقi٪h9Z*XeǆbZކh{c9v&6KUc	 xl((/\4VlftB>!Ӷ͡ԦCgfPPWB=r$$g]c(0N^E͒" _%%YpSL\MN! N_?F@_z
	Q :x|((+#]%odk&;p!.
IHp	<>ˋ#~g4_9wPqł+4ˋ2/ܼmx.-V h<FJ_lpӗyߝ"̶_Ƞr#
[ZUFy<Bo7l@ݵ+]
($řK࢒Sg4Of`xCPż2\SE[žCZ C8QPL/uv*+?sv5|'J]njOm. ns/B݀S8~>SmZbex6ڛonQZYx((Rsz]ߟsB4K =;h 2|7GpWɉisg8xxaq]Z:

R.	@AQ8+3):QbdZm q}=sI ~Ws,%7|WroN|˽5pl|ꢱEO5omQێ]箅NFTb%-MIPu3Aq)
λڊy3ٞ7҉8MQprB(NPx+pj|P6kg]4#·NoBaN(Vz6JE:sBq_T[CGqSgi.N4D`8PI\S3m2ݵ`gD.*ἼWɝu>۶.N""S.k~?\'wjLY8JYf.pp:BK  0EQ!#GC T`ؓcf^P\ @ T` Ź`بr1EA PS x'ݶдglpb PV OO
phB P_ @ PF a! (E,Z] ʮtaaV(R8{p fH`A%(sBq+)՝)?;    IENDB`

static/script.js:
document.addEventListener('DOMContentLoaded', function () {
    if (typeof Blockly === 'undefined') {
        console.error('Blockly is not defined.');
        return;
    }

    // Após carregar todos os blocos
    setTimeout(() => {
        if (Blockly.Blocks['math_change']) {
            delete Blockly.Blocks['math_change'];
        }
    }, 1000); // Ajuste o tempo conforme necessário
    
    Blockly.Themes.blackbg = Blockly.Theme.defineTheme('blackbg', {
        'base': Blockly.Themes.Classic,
        'componentStyles': {
            'workspaceBackgroundColour': '#1e1e1e',
            'toolboxBackgroundColour': 'blackBackground',
            'toolboxForegroundColour': '#fff',
            'flyoutBackgroundColour': '#252526',
            'flyoutForegroundColour': '#ccc',
            'flyoutOpacity': 1,
            'scrollbarColour': '#797979',
            'insertionMarkerColour': '#fff',
            'insertionMarkerOpacity': 0.3,
            'scrollbarOpacity': 0.4,
            'cursorColour': '#d0d0d0',
            'blackBackground': '#333',
        }
    });

    const workspace = Blockly.inject('blocklyDiv', {
        toolbox: document.getElementById('toolbox'),
        theme: Blockly.Themes.blackbg,
        zoom: {
            controls: true,
            wheel: true,
            startScale: 1.0,
            maxScale: 3,
            minScale: 0.3,
            scaleSpeed: 1.2
        },
        grid: {
            spacing: 20,
            length: 3,
            colour: '#ccc',
            snap: true
        },
        trashcan: true,
    });

    // Definindo Blockly.Arduino caso não esteja definido
    if (typeof Blockly.Arduino === 'undefined') {
        Blockly.Arduino = new Blockly.Generator('Arduino');
        Blockly.Arduino.addReservedWords('code');
        Blockly.Arduino.ORDER_ATOMIC = 0;
        Blockly.Arduino.ORDER_NONE = 99;
    }

    Blockly.Variables.createVariableButtonHandler = function(workspace, opt_callback, opt_types) {
        Blockly.prompt('Enter a name for your variable:', '', function(text) {
            if (text) {
                const variableTypes = opt_types || [''];
                Blockly.Variables.getOrCreateVariablePackage(workspace, null, text, variableTypes[0]);
                if (opt_callback) {
                    opt_callback(text);
                }
                workspace.updateToolbox(document.getElementById('toolbox'));
            }
        });
    };

    // Adicionando o callback para o botão de criação de variável
    workspace.registerButtonCallback('createVariable', function(button) {
        Blockly.Variables.createVariableButtonHandler(button.getTargetWorkspace())
            .then(() => workspace.updateToolbox(document.getElementById('toolbox')));
    });


    workspace.registerButtonCallback('createTypedVariable', function(button) {
        Blockly.Variables.createVariableButtonHandler(button.getTargetWorkspace(), null, ['Number', 'String', 'Boolean']);
        workspace.updateToolbox(document.getElementById('toolbox'));
    });


    let language = 'arduino';

    window.updateLanguage = function () {
        language = 'arduino';
        Blockly.Arduino = new Blockly.Generator('Arduino');
        Blockly.Arduino.addReservedWords('code');
        Blockly.Arduino.nameDB_ = new Blockly.Names(Blockly.Arduino.RESERVED_WORDS_);
        Blockly.Arduino.nameDB_.populateVariables(Blockly.Variables.allUsedVarModels(workspace));
        Blockly.Arduino.nameDB_.populateProcedures(Blockly.Procedures.allProcedures(workspace));
        updateCode();
    };

    function updateCode() {
        Blockly.Arduino.init(Blockly.getMainWorkspace());
        var code;
        let languageClass;
        let generator;
        try {
            switch (language) {
                case 'arduino':
                    generator = Blockly.Arduino;
                    languageClass = 'language-cpp';
                    break;
                default:
                    generator = Blockly.Arduino;
                    languageClass = 'language-cpp';
                    break;
            }

            generator.init(workspace);
            code = generator.workspaceToCode(Blockly.getMainWorkspace());

        } catch (error) {
            code = "// Error generating code: " + error.message;
            languageClass = 'language-cpp';
            console.error('Error generating code:', error);
        }

        const output = document.getElementById('code-output');
        output.textContent = code;
        output.className = 'hljs ' + languageClass;
        hljs.highlightElement(output);
    }

    document.getElementById('executeBtn').addEventListener('click', function () {
        const workspace = Blockly.getMainWorkspace();
        const codeOutput = Blockly.Arduino.workspaceToCode(workspace);

        const terminal = document.getElementById('terminal');
        terminal.innerHTML = '';

        function terminalLog(msg) {
            const messageElement = document.createElement('div');
            messageElement.textContent = msg;
            terminal.appendChild(messageElement);
        }

        const originalConsoleLog = console.log;
        console.log = function (...args) {
            args.forEach(arg => terminalLog(String(arg)));
            originalConsoleLog.apply(console, args);
        };

        const originalConsoleError = console.error;
        console.error = function (...args) {
            args.forEach(arg => terminalLog('Error: ' + String(arg)));
            originalConsoleError.apply(console, args);
        };

        const originalAlert = window.alert;
        window.alert = function (msg) {
            terminalLog(String(msg));
        };

        try {
            (function() {
                eval(codeOutput);
            })();
        } catch (error) {
            terminalLog('Error executing code: ' + error.message);
            console.error('Error executing code:', error);
        } finally {
            console.log = originalConsoleLog;
            console.error = originalConsoleError;
            window.alert = originalAlert;
        }
    });

    document.getElementById('saveBtn').addEventListener('click', function () {
        const xml = Blockly.Xml.workspaceToDom(workspace);
        const xmlText = Blockly.Xml.domToPrettyText(xml);
        const blob = new Blob([xmlText], {type: 'text/xml'});
        const a = document.createElement('a');
        a.href = URL.createObjectURL(blob);
        a.download = 'blockly_blocks.xml';
        a.click();
    });

    document.getElementById('openBtn').addEventListener('click', function () {
        const input = document.createElement('input');
        input.type = 'file';
        input.accept = '.xml';
        input.onchange = function (event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function (e) {
                    const xmlText = e.target.result;
                    const xml = Blockly.utils.xml.textToDom(xmlText);
                    Blockly.Xml.domToWorkspace(xml, workspace);
                    refreshVariables(workspace);
                };
                reader.readAsText(file);
            }
        };
        input.click();
    });

    const extensionInput = document.getElementById('extensionInput');

    Blockly.getMainWorkspace().registerButtonCallback('sendExtension', function() {
        extensionInput.click();
    });

    function getBlocksFromScript(scriptContent) {
        const blockTypes = [];
        const blockDefRegex = /Blockly\.Blocks\['(.*?)'\]/g;
        let match;
        while ((match = blockDefRegex.exec(scriptContent)) !== null) {
            blockTypes.push(match[1]);
        }
        console.log("Extracted block types:", blockTypes);
        return blockTypes;
    }

    function registerExtension(scriptContent) {
        const extensionRegex = /Blockly\.Extensions\.register\('(.*?)',\s*function\s*\(\)\s*{([\s\S]*?)}\);/g;
        let match;
        while ((match = extensionRegex.exec(scriptContent)) !== null) {
            const extensionName = match[1];
            const extensionCode = match[2];
            try {
                eval(`Blockly.Extensions.register('${extensionName}', function() {${extensionCode}});`);
                console.log(`Registered extension: ${extensionName}`);
            } catch (error) {
                console.error(`Error registering extension ${extensionName}:`, error);
            }
        }
    }

    function registerGenerators(scriptContent) {
        function createAndRegisterGenerator(language, blockType, generatorCode) {
            if (!Blockly[language]) {
                Blockly[language] = {};
            }
            try {
                eval(`Blockly.${language}['${blockType}'] = function(block) {${generatorCode}};`);
                console.log(`Registered ${language} generator for block: ${blockType}`);
            } catch (error) {
                console.error(`Error registering ${language} generator for block: ${blockType}`, error);
            }
        }

        const generatorRegex = /Blockly\.(\w+)\['(.*?)'\]\s*=\*\s*function\s*\(block\)\s*{([\s\S]*?)};/g;
        let match;
        while ((match = generatorRegex.exec(scriptContent)) !== null) {
            const language = match[1];
            createAndRegisterGenerator(language, match[2], match[3]);
        }

        const languages = ['Arduino'];
        languages.forEach(language => {
            const generatorRegex = new RegExp(`Blockly\\.${language}\\['(.*?)'\\]\\s*=\\s*function\\s*\\(block\\)\\s*{([\\s\\S]*?)};`, 'g');
            let match;
            while ((match = generatorRegex.exec(scriptContent)) !== null) {
                createAndRegisterGenerator(language, match[1], match[2]);
            }
        });

        languages.forEach(language => {
            console.log(`Registered ${language} generators:`, Object.keys(Blockly[language] || {}));
        });
    }

    extensionInput.addEventListener('change', function (event) {
        const file = event.target.files[0];
        if (file) {
            const reader = new FileReader();
            reader.onload = function (e) {
                const scriptContent = e.target.result;
                
                try {
                    (new Function(scriptContent))();

                    registerExtension(scriptContent);
                    registerGenerators(scriptContent);

                    const scriptName = file.name.split('.')[0];
                    const newCategory = document.createElement('category');
                    newCategory.setAttribute('name', scriptName);
                    newCategory.setAttribute('colour', '160');

                    const blocks = getBlocksFromScript(scriptContent);
                    blocks.forEach(block => {
                        const blockNode = document.createElement('block');
                        blockNode.setAttribute('type', block);
                        newCategory.appendChild(blockNode);
                    });

                    const extensionsCategory = document.getElementById('extensionsCategory');
                    const sendExtensionButton = extensionsCategory.querySelector('button');
                    extensionsCategory.insertBefore(newCategory, sendExtensionButton.nextSibling);

                    workspace.updateToolbox(document.getElementById('toolbox'));

                    console.log("Extension loaded and registered:", scriptName);
                    console.log("Blocks found:", blocks);
                } catch (error) {
                    console.error("Error loading extension:", error);
                }
            };
            reader.readAsText(file);
        }
    });

    function refreshVariables(workspace) {
        const variables = Blockly.Variables.allUsedVarModels(workspace);
        variables.sort((a, b) => a.name.localeCompare(b.name)); // Ordenar as variáveis alfabeticamente

        workspace.getAllBlocks().forEach(block => {
            if (typeof block.updateVariableFieldDropdown === 'function') {
                block.updateVariableFieldDropdown();
            }
        });

        if (workspace.toolbox_) {
            workspace.toolbox_.refreshSelection();
        }
    }

    workspace.addChangeListener(function(event) {
        if (event.type === Blockly.Events.BLOCK_CREATE || 
            event.type === Blockly.Events.BLOCK_DELETE || 
            event.type === Blockly.Events.BLOCK_CHANGE || 
            event.type === Blockly.Events.VAR_CREATE || 
            event.type === Blockly.Events.VAR_DELETE || 
            event.type === Blockly.Events.VAR_RENAME) {
            refreshVariables(workspace);
        }
        updateCode();
    });

    workspace.addChangeListener(updateCode);
});


static/style.css:
/* static/style.css */

body {
    font-family: Arial, sans-serif;
    background-color: #2b2b2b;
    color: #f1f1f1;
    margin: 0;
    padding: 0;
}

header {
    background-color: #1e1e1e;
    padding: 10px 0;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
}

nav ul {
    list-style: none;
    padding: 0;
    margin: 0;
    display: flex;
    justify-content: center;
}

nav ul li {
    margin: 0 15px;
    position: relative;
}

nav ul li a {
    color: #f1f1f1;
    text-decoration: none;
    font-weight: bold;
}

nav ul li a:hover {
    color: #ff9800;
}

nav ul li ul {
    display: none;
    position: absolute;
    top: 100%;
    left: 0;
    background-color: #1e1e1e;
    padding: 10px 0;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
    z-index: 1000;
}

nav ul li:hover ul {
    display: block;
}

nav ul li ul li {
    margin: 0;
}

nav ul li ul li a {
    padding: 10px 20px;
    display: block;
}

nav ul li ul li a:hover {
    background-color: #444;
}

.container {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    min-height: 100vh;
}

.editor-container, .output-container, .terminal-container {
    width: 90%;
    max-width: 1200px;
    margin: 10px 0;
    border: 2px solid #444;
    border-radius: 8px;
    background-color: #1e1e1e;
    padding: 20px;
}

h2 {
    color: #ffffff;
}

.blockly-area {
    height: 480px;
    width: 100%;
    border: 2px solid #444;
    border-radius: 8px;
    background-color: #1e1e1e;
}

.blocklyText {
    fill: #000000 !important;
}

.output-container select {
    width: 100%;
    padding: 10px;
    margin-bottom: 10px;
    background-color: #444;
    color: #f1f1f1;
    border: none;
    border-radius: 4px;
}

#code-output {
    width: 100%;
    height: 400px;
    border: 2px solid #444;
    border-radius: 8px;
    background-color: #1e1e1e;
    padding: 10px;
    overflow: auto;
    white-space: pre;
}

.hljs {
    background: #1e1e1e;
    color: #f1f1f1;
}

.blocklyTreeLabel {
    color: #ffffff;
}

.terminal-container {
    height: 300px;
    overflow-y: auto;
    background-color: #000;
    color: #00ff00;
    font-family: 'Courier New', Courier, monospace;
    padding: 10px;
    border-radius: 5px;
    width: 100%;
}

.terminal-container h2 {
    color: #ffffff;
    margin-top: 0;
}

.terminal-container div {
    margin-bottom: 5px;
}


